<?php

return <<<'VALUE'
"namespace IPS\\Theme;\nclass class_core_front_global extends \\IPS\\Theme\\Template\n{\n\tpublic $cache_key = '0b2449a0f3ecc2efcbf0c0545e5a6ce8';\n\tfunction acknowledgeWarning( $warnings=array() ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $warnings as $idx => $warning ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $idx === 0 ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsMessage ipsMessage_error'>\n\t\t\t<h4 class='ipsMessage_title'>\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::load( $warning->moderator )->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'you_have_been_warned', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->isBanned() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $warning->note_member ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class='ipsType_reset ipsType_medium'>{$warning->note_member}<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<p class='ipsType_reset ipsType_medium'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'must_acknowledge_msg', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t<br>\n\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=warnings&do=view&id={$warning->member}&w={$warning->id}\", null, \"warn_view\", array( \\IPS\\Member::loggedIn()->members_seo_name ), 0 )->addRef((string) \\IPS\\Request::i()->url()), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_veryLight' data-ipsDialog data-ipsDialog-size='narrow'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_warning_details', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t<br>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction announcementContentTop(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( $announcements = \\IPS\\core\\Announcements\\Announcement::loadAllByLocation('content') ):\n$return .= <<<CONTENT\n\n\t<div class='cAnnouncementsContent'>\n\t\t\nCONTENT;\n\nforeach ( $announcements as $announcement ):\n$return .= <<<CONTENT\n\n\t\t<div class='cAnnouncementContentTop ipsMessage ipsMessage_\nCONTENT;\n$return .= htmlspecialchars( $announcement->color, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n ipsType_center'>\n            \nCONTENT;\n\nif ( $announcement->type == \\IPS\\core\\Announcements\\Announcement::TYPE_CONTENT ):\n$return .= <<<CONTENT\n\n\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $announcement->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n            \nCONTENT;\n\nelseif ( $announcement->type == \\IPS\\core\\Announcements\\Announcement::TYPE_URL ):\n$return .= <<<CONTENT\n\n            <a href='\nCONTENT;\n$return .= htmlspecialchars( $announcement->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target=\"_blank\" rel='noopener'>\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n            \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n            <span>\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n            \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction announcementSidebar( $announcements ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div class='ipsBox ipsSpacer_bottom' id=\"cAnnouncementSidebar\">\n\t<span class=\"cAnnouncementIcon\"><i class='fa fa-bullhorn fa-3x fa-fw'><\/i><\/span>\n\t<h3 class='ipsType_minorHeading ipsType_center ipsType_medium ipsSpacer_bottom'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'announcements', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t<ul class='ipsList_reset'>\n\t\nCONTENT;\n\nforeach ( $announcements as $announcement ):\n$return .= <<<CONTENT\n\n\t\t<li class=\"cAnnouncementSidebar ipsMessage ipsMessage_\nCONTENT;\n$return .= htmlspecialchars( $announcement->color, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n            \nCONTENT;\n\nif ( $announcement->type == \\IPS\\core\\Announcements\\Announcement::TYPE_CONTENT ):\n$return .= <<<CONTENT\n\n            <a href='\nCONTENT;\n$return .= htmlspecialchars( $announcement->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n            \nCONTENT;\n\nelseif ( $announcement->type == \\IPS\\core\\Announcements\\Announcement::TYPE_URL ):\n$return .= <<<CONTENT\n\n            <a href='\nCONTENT;\n$return .= htmlspecialchars( $announcement->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target=\"_blank\" rel='noopener'>\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n            \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n            <span>\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n            \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n        <\/li>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction announcementTop(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( $announcements = \\IPS\\core\\Announcements\\Announcement::loadAllByLocation('top') ):\n$return .= <<<CONTENT\n\n<div class='cAnnouncements' data-controller=\"core.front.core.announcementBanner\" >\n\t\nCONTENT;\n\nforeach ( $announcements as $announcement ):\n$return .= <<<CONTENT\n\n\t<div class='cAnnouncementPageTop ipsJS_hide ipsMessage ipsMessage_\nCONTENT;\n$return .= htmlspecialchars( $announcement->color, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-announcementId=\"\nCONTENT;\n$return .= htmlspecialchars( $announcement->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n        \nCONTENT;\n\nif ( $announcement->type == \\IPS\\core\\Announcements\\Announcement::TYPE_CONTENT ):\n$return .= <<<CONTENT\n\n        <a href='\nCONTENT;\n$return .= htmlspecialchars( $announcement->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n        \nCONTENT;\n\nelseif ( $announcement->type == \\IPS\\core\\Announcements\\Announcement::TYPE_URL ):\n$return .= <<<CONTENT\n\n        <a href='\nCONTENT;\n$return .= htmlspecialchars( $announcement->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target=\"_blank\" rel='noopener'>\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n        \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n        <span>\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t<a href='#' data-role=\"dismissAnnouncement\">\u00d7<\/a>\n\t<\/div>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction blankTemplate( $html, $title=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<!DOCTYPE html>\n<html lang=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->bcp47(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" dir=\"\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->isrtl ):\n$return .= <<<CONTENT\nrtl\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nltr\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t<head>\n\t\t<title>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->getTitle( $title ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/title>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeMeta(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeCSS(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['js_include'] != 'footer' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeJS(  );\nendif;\n$return .= <<<CONTENT\n\n\t<\/head>\n\t<body class='ipsApp ipsApp_front ipsClearfix ipsLayout_noBackground \nCONTENT;\n\nif ( isset( \\IPS\\Request::i()->cookie['hasJS'] ) ):\n$return .= <<<CONTENT\nipsJS_has\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsJS_none\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsClearfix\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->bodyClasses as $class ):\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $class, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Output::i()->globalControllers ):\n$return .= <<<CONTENT\ndata-controller='\nCONTENT;\n\n$return .= htmlspecialchars( implode( ',', \\IPS\\Output::i()->globalControllers ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset( \\IPS\\Output::i()->inlineMessage ) ):\n$return .= <<<CONTENT\ndata-message=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->inlineMessage, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t{$html}\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['js_include'] == 'footer' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeJS(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Output::i()->endBodyCode;\n$return .= <<<CONTENT\n\n\t<\/body>\n<\/html>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction box( $content=NULL, $classes=array() ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div class='ipsBox \nCONTENT;\n\nif ( \\count( $classes) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= htmlspecialchars( implode( ' ', $classes ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t{$content}\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction breadcrumb( $position='top', $markRead=TRUE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<nav class='ipsBreadcrumb ipsBreadcrumb_\nCONTENT;\n$return .= htmlspecialchars( $position, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n ipsFaded_withHover'>\n\t\nCONTENT;\n\nif ( $position == 'bottom' ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->rssMenu(  );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t<ul class='ipsList_inline ipsPos_right'>\n\t\t\nCONTENT;\n\n$defaultStream = \\IPS\\core\\Stream::defaultStream();\n$return .= <<<CONTENT\n\n\t\t<li \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'discover' ) )  ):\n$return .= <<<CONTENT\n class='ipsHide'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t<a data-action=\"defaultStream\" class='ipsType_light \nCONTENT;\n\nif ( ! $defaultStream ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'  href='\nCONTENT;\n\nif ( $defaultStream ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $defaultStream->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='icon-newspaper'><\/i> <span>\nCONTENT;\n\nif ( $defaultStream ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $defaultStream->_title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span><\/a>\n\t\t<\/li>\n\t\t\nCONTENT;\n\nif ( $markRead && \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a data-action=\"markSiteRead\" class='ipsType_light' data-controller=\"core.front.core.markRead\" href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=markread\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"mark_site_as_read\", array(), 0 )->addRef((string) \\IPS\\Request::i()->url()), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mark_site_read', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mark_site_read_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\n\t<ul data-role=\"breadcrumbList\">\n\t\t<li>\n\t\t\t<a title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'home', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" href='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\n'>\n\t\t\t\t<span><i class='fa fa-home'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'home', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( \\count( \\IPS\\Output::i()->breadcrumb ) ):\n$return .= <<<CONTENT\n <i class='fa fa-angle-right'><\/i>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/a>\n\t\t<\/li>\n\t\t\nCONTENT;\n\n$last = end(\\IPS\\Output::i()->breadcrumb);\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->breadcrumb as $k => $b ):\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t\nCONTENT;\n\nif ( $b[0] === NULL ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $b[1], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $b[0], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<span>\nCONTENT;\n$return .= htmlspecialchars( $b[1], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $b != $last ):\n$return .= <<<CONTENT\n<i class='fa fa-angle-right'><\/i>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/nav>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction buttons( $buttons ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<ul class='ipsToolList ipsToolList_horizontal ipsClearfix'>\n\t\nCONTENT;\n\nforeach ( $buttons as $button ):\n$return .= <<<CONTENT\n\n\t\t<li class='\nCONTENT;\n\nif ( isset( $button['hidden'] ) and $button['hidden'] ):\n$return .= <<<CONTENT\nipsJS_hide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( isset( $button['id'] ) ):\n$return .= <<<CONTENT\nid=\"\nCONTENT;\n$return .= htmlspecialchars( $button['id'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t<a\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['link'] ) ):\n$return .= <<<CONTENT\nhref='\nCONTENT;\n$return .= htmlspecialchars( $button['link'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\ttitle='\nCONTENT;\n\n$val = \"{$button['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'\n\t\t\t\tclass='ipsButton ipsButton_alternate ipsButton_small ipsButton_fullWidth \nCONTENT;\n\nif ( isset( $button['class'] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $button['class'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'\n\t\t\t\trole=\"button\"\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['id'] ) ):\n$return .= <<<CONTENT\nid=\"\nCONTENT;\n$return .= htmlspecialchars( $button['id'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_button\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['target'] ) ):\n$return .= <<<CONTENT\ntarget=\"\nCONTENT;\n$return .= htmlspecialchars( $button['target'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nif ( $button['target'] == '_blank' ):\n$return .= <<<CONTENT\n rel=\"noopener\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['data'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $button['data'] as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\tdata-\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['hotkey'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\tdata-keyAction='\nCONTENT;\n$return .= htmlspecialchars( $button['hotkey'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t>\n\t\t\t\t\nCONTENT;\n\nif ( $button['icon'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $button['icon'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i>&nbsp;\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$val = \"{$button['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\n\t\t\t\t\nCONTENT;\n\nif ( isset($button['dropdown']) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&nbsp;<i class='fa fa-caret-down'><\/i>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/a>\n\t\t<\/li>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/ul>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction cachingLog( $log ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"elCachingLog\">\n\t\nCONTENT;\n\nforeach ( $log as $i => $log ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$i = \\str_replace( '.', '_', $i);\n$return .= <<<CONTENT\n\n\t\t<div class=\"cCachingLog\" data-ipsDialog data-ipsDialog-content=\"#elCachingLog\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu\">\n\t\t\t\nCONTENT;\n\nif ( $log[0] === 'get' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"cCachingLogMethod cCachingLogMethod_get\">get<\/span>\n\t\t\t\t<span class=\"cCachingLogKey\">\nCONTENT;\n$return .= htmlspecialchars( $log[1], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nelseif ( $log[0] === 'set' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"cCachingLogMethod cCachingLogMethod_set\">set<\/span>\n\t\t\t\t<span class=\"cCachingLogKey\">\nCONTENT;\n$return .= htmlspecialchars( $log[1], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nelseif ( $log[0] === 'check' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"cCachingLogMethod cCachingLogMethod_check\">check<\/span>\n\t\t\t\t<span class=\"cCachingLogKey\">\nCONTENT;\n$return .= htmlspecialchars( $log[1], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nelseif ( $log[0] === 'delete' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"cCachingLogMethod cCachingLogMethod_delete\">delete<\/span>\n\t\t\t\t<span class=\"cCachingLogKey\">\nCONTENT;\n$return .= htmlspecialchars( $log[1], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"cCachingLogMethod\">Redis<\/span>\n\t\t\t\t<span class=\"cCachingLogKey\">\nCONTENT;\n$return .= htmlspecialchars( $log[1], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t<div id='elCachingLog\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsPad ipsHide'>\n\t\t\t\nCONTENT;\n\nif ( ! empty( $log[2] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<pre class=\"prettyprint lang-php\">\nCONTENT;\n$return .= htmlspecialchars( $log[2], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/pre>\n\t\t\t\t<hr class=\"ipsHr\">\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( isset( $log[3] ) ):\n$return .= <<<CONTENT\n<pre class=\"prettyprint lang-php\">\nCONTENT;\n$return .= htmlspecialchars( $log[3], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/pre>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t<hr class=\"ipsHr\">\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction comment( $item, $comment, $editorName, $app, $type, $class='' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$idField = $comment::$databaseColumnId;\n$return .= <<<CONTENT\n\n<div id='comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap' data-controller='core.front.core.comment' data-commentApp='\nCONTENT;\n$return .= htmlspecialchars( $app, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-commentType='\nCONTENT;\n$return .= htmlspecialchars( $type, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-commentID=\"\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-quoteData='\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( array('userid' => $comment->author()->member_id, 'username' => $comment->author()->name, 'timestamp' => $comment->mapped('date'), 'contentapp' => $app, 'contenttype' => $type, 'contentclass' => $class, 'contentid' => $item->id, 'contentcommentid' => $comment->$idField) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsComment_content ipsType_medium'>\n\t\nCONTENT;\n\nif ( ( \\IPS\\Settings::i()->reputation_enabled and \\IPS\\IPS::classUsesTrait( $comment, 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_highlight and $comment->reactionCount() >= \\IPS\\Settings::i()->reputation_highlight ) OR $comment->isFeatured() ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $comment->isFeatured() ):\n$return .= <<<CONTENT\n\n\t\t\t<strong class='ipsComment_popularFlag' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_a_featured_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-star'><\/i><\/strong>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<strong class='ipsComment_popularFlag' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_a_popular_comment', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-heart'><\/i><\/strong>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t<div class='ipsComment_header ipsPhotoPanel ipsPhotoPanel_mini'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $comment->author(), 'mini', $comment->warningRef() );\n$return .= <<<CONTENT\n\n\t\t<div>\n\t\t\t<div class='ipsPos_right ipsType_reset ipsType_light ipsType_blendLinks'>\n\t\t\t\t<ul class='ipsList_inline ipsComment_tools'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canReportOrRevoke() === TRUE ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('report'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-remoteSubmit data-ipsDialog-size='medium' data-ipsDialog-flashMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_submit_success', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-action='reportComment' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><span class='ipsResponsive_showPhone ipsResponsive_inline'><i class='fa fa-flag'><\/i><\/span><span class='ipsResponsive_hidePhone ipsResponsive_inline'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_reply', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span><\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->ip_address and \\IPS\\Member::loggedIn()->modPermission('can_use_ip_tools') and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><span class='ipsResponsive_hidePhone ipsType_blendLinks'>(<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=modcp&controller=modcp&tab=ip_tools&ip=$comment->ip_address\", null, \"modcp_ip_tools\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$sprintf = array($comment->ip_address); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ip_prefix', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/a>)<\/span><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\count( $comment->sharelinks() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><a class='ipsType_blendLinks' href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $comment->id ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_this_comment', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-closeOnClick='false' id='elShareComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role='shareComment'><i class='fa fa-share-alt'><\/i><\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\count( $item->commentMultimodActions() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><span class='ipsCustomInput'>\n\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"multimod[\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\" value=\"1\" data-role=\"moderation\" data-actions=\"\nCONTENT;\n\nif ( $comment->canSplit() ):\n$return .= <<<CONTENT\nsplit merge\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $comment->hidden() === -1 AND $comment->canUnhide() ):\n$return .= <<<CONTENT\nunhide\nCONTENT;\n\nelseif ( $comment->hidden() === 1 AND $comment->canUnhide() ):\n$return .= <<<CONTENT\napprove\nCONTENT;\n\nelseif ( $comment->canHide() ):\n$return .= <<<CONTENT\nhide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $comment->canDelete() ):\n$return .= <<<CONTENT\ndelete\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-state='\nCONTENT;\n\nif ( $comment->tableStates() ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $comment->tableStates(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t<span><\/span>\n\t\t\t\t\t\t<\/span><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\t<h3 class='ipsComment_author ipsType_blendLinks'>\n\t\t\t\t<strong class='ipsType_normal'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLink( $comment->author(), $comment->warningRef() );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reputationBadge( $comment->author() );\n$return .= <<<CONTENT\n\n\t\t\t<\/h3>\n\t\t\t<p class='ipsComment_meta ipsType_light ipsType_medium'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsType_blendLinks'>{$comment->dateLine()}<\/a>\n\t\t\t\t\nCONTENT;\n\nif ( $comment->editLine() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t(\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edited_lc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n)\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() AND $comment->hidden() != -2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; \nCONTENT;\n$return .= htmlspecialchars( $comment->hiddenBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelseif ( $comment->hidden() == -2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; \nCONTENT;\n$return .= htmlspecialchars( $comment->deletedBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->modPermission('mod_see_warn') and $comment->warning ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->commentWarned( $comment );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\t<div class='ipsPad'>\n\t\t\n\t\t<div data-role='commentContent' class='ipsType_normal ipsType_richText ipsContained' data-controller='core.front.core.lightboxedImages'>\n\t\t\t\nCONTENT;\n\nif ( $comment->hidden() === 1 && $comment->author()->member_id == \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t<strong class='ipsType_medium ipsType_warning'><i class='fa fa-info-circle'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'comment_awaiting_approval', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t{$comment->content()}\n\t\t\t\n\t\t\t\nCONTENT;\n\nif ( $comment->editLine() ):\n$return .= <<<CONTENT\n\n\t\t\t\t{$comment->editLine()}\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\n\t\t<div class='ipsItemControls'>\n\t\t\t\nCONTENT;\n\nif ( $comment->hidden() !== 1 && \\IPS\\IPS::classUsesTrait( $comment, 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reputation( $comment );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<ul class='ipsComment_controls ipsClearfix ipsItemControls_left' data-role=\"commentControls\">\n\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() === 1 && ( $comment->canUnhide() || $comment->canDelete() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('unhide')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_positive' data-action='approveComment'><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'approve', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('delete')->csrf()->setPage('page',\\IPS\\Request::i()->page), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='deleteComment' data-updateOnDelete=\"#commentCount\" class='ipsButton ipsButton_verySmall ipsButton_negative'><i class='fa fa-times'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canEdit() || $comment->canSplit() || $comment->canHide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href='#elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-appendTo='#comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'options', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &nbsp;<i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t\t<ul id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->mapped('first') and $comment->item()->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( 'do', 'edit' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('edit'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='editComment'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canSplit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('split'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='splitComment' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->addToStack( $item::$title )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split_to_new', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment instanceof \\IPS\\Content\\Hideable and $comment->canHide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('hide')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() === 0 and $item->canComment() and $editorName ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li data-ipsQuote-editor='\nCONTENT;\n$return .= htmlspecialchars( $editorName, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsQuote-target='#comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsJS_show'>\n\t\t\t\t\t\t\t<button class='ipsButton ipsButton_light ipsButton_verySmall ipsButton_narrow cMultiQuote ipsHide' data-action='multiQuoteComment' data-ipsTooltip data-ipsQuote-multiQuote data-mqId='mq\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'multiquote', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-plus'><\/i><\/button>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li data-ipsQuote-editor='\nCONTENT;\n$return .= htmlspecialchars( $editorName, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsQuote-target='#comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsJS_show'>\n\t\t\t\t\t\t\t<a href='#' data-action=\"quoteComment\" data-ipsQuote-singleQuote>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'quote', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->mapped('first') and $comment->item()->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( 'do', 'edit' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('edit'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='editComment'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canPromoteToSocialMedia() || $comment->canDelete() || $comment->canSplit() || ( $comment instanceof \\IPS\\Content\\Hideable AND ( ( !$comment->hidden() and $comment->canHide() ) || ( $comment->hidden() and $comment->canUnhide() ) ) ) || ( $comment->hidden() == -2 AND \\IPS\\Member::loggedIn()->modPermission('can_manage_deleted_content') ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href='#elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-appendTo='#comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'options', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &nbsp;<i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t\t<ul id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() == -2 AND \\IPS\\Member::loggedIn()->modPermission('can_manage_deleted_content') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('restore')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-confirmSubMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_visible_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_visible', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('restore')->csrf()->setQueryString( 'restoreAsHidden', 1 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-confirmSubMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_hidden_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_hidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('delete')->csrf()->setQueryString( 'immediately', 1 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-confirmSubMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete_immediately_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete_immediately', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment instanceof \\IPS\\Content\\Hideable ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( !$comment->hidden() and $comment->canHide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('hide')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $comment->hidden() and $comment->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('unhide')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unhide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canSplit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('split'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='splitComment' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->addToStack( $item::$title )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split_to_new', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('delete')->csrf()->setPage('page',\\IPS\\Request::i()->page), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='deleteComment' data-updateOnDelete=\"#commentCount\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->isFeatured() AND $item->canUnfeatureComment() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('unfeature')->csrf()->setPage('page',\\IPS\\Request::i()->page), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"unrecommendComment\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unrecommend_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( !$comment->isFeatured() AND $item->canFeatureComment() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('feature')->csrf()->setPage('page', \\IPS\\Request::i()->page), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recommend_comment', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog-remoteSubmit data-ipsDialog-size='narrow' data-action=\"recommendComment\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recommend_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canPromoteToSocialMedia() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->promoteLink( $comment );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsHide' data-role='commentLoading'>\n\t\t\t\t\t<span class='ipsLoading ipsLoading_tiny ipsLoading_noAnim'><\/span>\n\t\t\t\t<\/li>\n\t\t\t<\/ul>\n\t\t<\/div>\n\t<\/div>\n\n\t<div class='ipsMenu ipsMenu_wide ipsHide cPostShareMenu' id='elShareComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu'>\n\t\t<div class='ipsPad'>\n\t\t\t<h4 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_this_comment', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t<hr class='ipsHr'>\n\t\t\t<h5 class='ipsType_normal ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'link_to_comment', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h5>\n\t\t\t<input type='text' value='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $comment->id ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsField_fullWidth'>\n\t\t\t\nCONTENT;\n\nif ( \\count( $comment->sharelinks() ) ):\n$return .= <<<CONTENT\n\n\t\t\t<h5 class='ipsType_normal ipsType_reset ipsSpacer_top'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_externally', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h5>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->sharelinks( $comment );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentContainer( $item, $comment ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$idField = $comment::$databaseColumnId;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$itemClassSafe = str_replace( '\\\\', '_', mb_substr( $comment::$itemClass, 4 ) );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $comment->isIgnored() ):\n$return .= <<<CONTENT\n\n\t<div class='ipsComment ipsComment_ignored ipsPad_half ipsType_light' id='elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ignoreCommentID='elComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ignoreUserID='\nCONTENT;\n$return .= htmlspecialchars( $comment->author()->member_id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ignoring_content', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n <a href='#elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' data-ipsMenu data-ipsMenu-menuID='elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' data-ipsMenu-appendTo='#elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"ignoreOptions\" title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_post_ignore_options', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsType_blendLinks'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'options', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t<ul class='ipsMenu ipsHide' id='elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu'>\n\t\t\t<li class='ipsMenu_item' data-ipsMenuValue='showPost'><a href='#'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'show_this_comment', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t<li class='ipsMenu_sep'><hr><\/li>\n\t\t\t<li class='ipsMenu_item' data-ipsMenuValue='stopIgnoring'><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ignore&do=remove&id={$comment->author()->member_id}\", null, \"ignore\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'stop_ignoring_posts_by', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ignore\", null, \"ignore\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'change_ignore_preferences', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t<\/ul>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n<a id='comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/a>\n<article \nCONTENT;\n\nif ( $comment->author()->hasHighlightedReplies() ):\n$return .= <<<CONTENT\ndata-memberGroup=\"\nCONTENT;\n$return .= htmlspecialchars( $comment->author()->member_group_id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n id='elComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsComment \nCONTENT;\n\nif ( ( \\IPS\\Settings::i()->reputation_enabled and \\IPS\\IPS::classUsesTrait( $comment, 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_highlight and $comment->reactionCount() >= \\IPS\\Settings::i()->reputation_highlight ) OR $comment->isFeatured() ):\n$return .= <<<CONTENT\nipsComment_popular\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsComment_parent ipsClearfix ipsClear \nCONTENT;\n\nif ( $comment->isIgnored() ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $comment->author()->hasHighlightedReplies() ):\n$return .= <<<CONTENT\nipsComment_highlighted\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $comment->hidden() OR $item->hidden() == -2 ):\n$return .= <<<CONTENT\nipsModerated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->comment( $item, $comment, $item::$formLangPrefix . 'comment', $item::$application, $item::$module, $itemClassSafe );\n$return .= <<<CONTENT\n\n<\/article>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentEditHistory( $editHistory, $comment ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !\\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\n\n<h1 class='ipsType_pageTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_history_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n<div class=\"ipsPad\" data-role=\"commentFeed\">\n\t\nCONTENT;\n\nif ( \\count($editHistory)  ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nforeach ( $editHistory as $edit ):\n$return .= <<<CONTENT\n\n\t<article class='ipsComment ipsComment_parent ipsClearfix ipsClear'>\n\t\t<div class='ipsComment_header ipsPhotoPanel ipsPhotoPanel_mini ipsPhotoPanel_notPhone'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::load( $edit['member'] ), 'mini' );\n$return .= <<<CONTENT\n\n\t\t\t<div>\n\t\t\t\t<h3 class='ipsComment_author ipsType_sectionHead'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::load( $edit['member'] )->link();\n$return .= <<<CONTENT\n\n\t\t\t\t<\/h3>\n\t\t\t\t<p class='ipsComment_meta ipsType_light'>\n\t\t\t\t\t\nCONTENT;\n\n$val = ( $edit['time'] instanceof \\IPS\\DateTime ) ? $edit['time'] : \\IPS\\DateTime::ts( $edit['time'] );$return .= $val->html();\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $edit['reason'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<br>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $edit['reason'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/p>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class='ipsAreaBackground_reset ipsPad'>\n\t\t\t<div class='ipsType_richText'>\n\t\t\t\t{$edit['new']}\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/article>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<article class='ipsComment ipsComment_parent ipsClearfix ipsClear'>\n\t\t<div class='ipsComment_header ipsPhotoPanel ipsPhotoPanel_mini ipsPhotoPanel_notPhone'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $comment->author(), 'mini' );\n$return .= <<<CONTENT\n\n\t\t\t<div>\n\t\t\t\t<h3 class='ipsComment_author ipsType_sectionHead'>\n\t\t\t\t\t{$comment->author()->link()}\n\t\t\t\t<\/h3>\n\t\t\t\t<p class='ipsComment_meta ipsType_light'>\n\t\t\t\t\t\nCONTENT;\n\n$val = ( $comment->mapped('date') instanceof \\IPS\\DateTime ) ? $comment->mapped('date') : \\IPS\\DateTime::ts( $comment->mapped('date') );$return .= $val->html();\n$return .= <<<CONTENT\n\n\t\t\t\t<\/p>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class='ipsAreaBackground_reset ipsPad'>\n\t\t\t<div class='ipsType_richText'>\n\t\t\t\t{$edit['old']}\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/article>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<p class='ipsType_large ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_edit_history', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentEditLine( $comment, $supportsReason=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<span class='ipsType_reset ipsType_medium ipsType_light' data-excludequote>\n\t<strong>\nCONTENT;\n\n$htmlsprintf = array(\\IPS\\DateTime::ts( $comment->mapped('edit_time') )->html(FALSE), ( $comment->mapped('edit_member_name') ) ? htmlspecialchars( $comment->mapped('edit_member_name'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE ) : \\IPS\\Member::loggedIn()->language()->addToStack('guest')); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'date_edited', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\nCONTENT;\n\nif ( $supportsReason && $comment->mapped('edit_reason') ):\n$return .= <<<CONTENT\n\n\t\t<br>\nCONTENT;\n$return .= htmlspecialchars( $comment->mapped('edit_reason'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->edit_log == 2 and ( \\IPS\\Settings::i()->edit_log_public or \\IPS\\Member::loggedIn()->modPermission('can_view_editlog') )  ):\n$return .= <<<CONTENT\n\n\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('editlog'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_history_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_history', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>(\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_history', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n)<\/a>\n\t\t\nCONTENT;\n\nif ( !$comment->mapped('edit_show') AND \\IPS\\Member::loggedIn()->modPermission('can_view_editlog') ):\n$return .= <<<CONTENT\n\n\t\t<br>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'comment_edit_show_anyways', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/span>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentMultimod( $item, $type='comment' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<input type=\"hidden\" name=\"csrfKey\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \/>\n\nCONTENT;\n\n$method = $type . 'MultimodActions';\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $actions = $item->$method() and \\count( $actions ) ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsClearfix\">\n\t\t<div class=\"ipsAreaBackground ipsPad ipsClearfix ipsJS_hide\" data-role=\"pageActionOptions\">\n\t\t\t<div class=\"ipsPos_right\">\n\t\t\t\t<select name=\"modaction\" data-role=\"moderationAction\">\n\t\t\t\t\t\nCONTENT;\n\nif ( \\in_array( 'approve', $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<option value='approve' data-icon='check-circle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'approve', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\in_array( 'split_merge', $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<option value='split' data-icon='expand'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t<option value='merge' data-icon='level-up'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'merge', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\in_array( 'hide', $actions ) or \\in_array( 'unhide', $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<optgroup label=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-icon='eye' data-action='hide'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\in_array( 'hide', $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<option value='hide'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\in_array( 'unhide', $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<option value='unhide'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unhide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/optgroup>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\in_array( 'delete', $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<option value='delete' data-icon='trash'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/select>\n\t\t\t\t<button type=\"submit\" class=\"ipsButton ipsButton_alternate ipsButton_verySmall\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'submit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/button>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentMultimodHeader( $item, $container, $type='comment' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\n$method = $type . 'MultimodActions';\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $actions = $item->$method() and \\count( $actions ) ):\n$return .= <<<CONTENT\n\n\t<ul class=\"ipsButtonRow ipsPos_right ipsClearfix\">\n\t\t<li>\n\t\t\t<a class=\"ipsJS_show\" href=\"#elCheck_menu\" id=\"elCheck\" title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'select_rows_tooltip', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip data-ipsAutoCheck data-ipsAutoCheck-context=\"\nCONTENT;\n$return .= htmlspecialchars( $container, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsMenu data-ipsMenu-activeClass=\"ipsButtonRow_active\">\n\t\t\t\t<span class=\"cAutoCheckIcon ipsType_medium\"><i class=\"fa fa-square-o\"><\/i><\/span> <i class=\"fa fa-caret-down\"><\/i>\n\t\t\t\t<span class='ipsNotificationCount' data-role='autoCheckCount'>0<\/span>\n\t\t\t<\/a>\n\t\t\t<ul class=\"ipsMenu ipsMenu_auto ipsMenu_withStem ipsHide\" id=\"elCheck_menu\">\n\t\t\t\t<li class=\"ipsMenu_title\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'select_rows', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t<li class=\"ipsMenu_item\" data-ipsMenuValue=\"all\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'all', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t<li class=\"ipsMenu_item\" data-ipsMenuValue=\"none\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'none', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t<li class=\"ipsMenu_sep\"><hr><\/li>\n\t\t\t\t<li class=\"ipsMenu_item\" data-ipsMenuValue=\"hidden\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t<li class=\"ipsMenu_item\" data-ipsMenuValue=\"unhidden\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unhidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t<li class=\"ipsMenu_item\" data-ipsMenuValue=\"unapproved\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unapproved', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t<\/ul>\n\t\t<\/li>\n\t<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentTableHeader( $comment, $status ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\n<div class='ipsDataList ipsAreaBackground_light ipsClearfix'>\n\t<div class='ipsDataItem'>\n\t\t<div class='ipsDataItem_icon'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $status->author() );\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t<div class='ipsDataItem_main'>\n\t\t\t<p class='ipsType_medium ipsType_light ipsType_blendLinks ipsType_reset'>\n\t\t\t\t\nCONTENT;\n\n$htmlsprintf = array($status->author()->link()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'status_updated_by', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t\t<div class='ipsType_richText ipsType_medium' data-ipsTruncate data-ipsTruncate-size='5 lines' data-ipsTruncate-type='remove'>\n\t\t\t\t{$status->truncated()}\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentWarned( $comment ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<!-- Moderator warning -->\n<div class=\"ipsType_reset ipsPad ipsAreaBackground_light ipsClearfix ipsPhotoPanel ipsPhotoPanel_mini\">\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::load( $comment->warning->moderator ), 'mini' );\n$return .= <<<CONTENT\n\n\t<div>\n\t\t<strong class='ipsType_warning ipsType_normal'>\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::load( $comment->warning->moderator )->name, \\IPS\\Member::load( $comment->warning->member )->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_given_post_warning', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t<br>\n\t\t<span class='ipsType_light'>\n\t\t\t<strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warn_reason_message', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong> \nCONTENT;\n\n$val = \"core_warn_reason_{$comment->warning->reason}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &middot; <strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warn_points_message', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong> \nCONTENT;\n$return .= htmlspecialchars( $comment->warning->points, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n &middot; <a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=warnings&do=view&id={$comment->warning->member}&w={$comment->warning->id}\", null, \"warn_view\", array( $comment->author()->members_seo_name ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_warning_details_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='narrow'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_warning_details', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/span>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction commentsAndReviewsTabs( $content, $id ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-controller='core.front.core.commentsWrapper' data-tabsId='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t{$content}\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction contentItemMessage( $message, $item, $id ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$member = \\IPS\\Member::load( $message['added_by'] );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$class = \\get_class( $item );\n$return .= <<<CONTENT\n\n<div class='cContentMessage \nCONTENT;\n\nif ( isset( $message['color'] ) && $message['color'] !== 'none' ):\n$return .= <<<CONTENT\ncContentMessage_color ipsMessage ipsMessage_\nCONTENT;\n$return .= htmlspecialchars( $message['color'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsBox\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsPhotoPanel ipsPhotoPanel_tiny ipsPad ipsSpacer_bottom'>\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $member, 'tiny' );\n$return .= <<<CONTENT\n\n\t<div>\n\t\t\nCONTENT;\n\nif ( $item->canOnMessage( 'edit' ) || $item->canOnMessage( 'delete' ) ):\n$return .= <<<CONTENT\n\n\t\t\t<ul class='ipsList_inline ipsList_noSpacing ipsPos_right ipsSpacer_bottom'>\n\t\t\t\t\nCONTENT;\n\nif ( $item->canOnMessage( 'edit' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a class='ipsButton ipsButton_link ipsButton_veryVerySmall' href='\nCONTENT;\n$return .= htmlspecialchars( $item->url()->csrf()->setQueryString( array( 'do' => 'messageForm', 'meta_id' => $id ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $item->canOnMessage( 'delete' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a class='ipsButton ipsButton_link ipsButton_veryVerySmall' href='\nCONTENT;\n$return .= htmlspecialchars( $item->url()->csrf()->setQueryString( array( 'do' => 'messageDelete', 'meta_id' => $id ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->richText( $message['message'], array('ipsType_normal') );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $member->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t<p class='ipsType_reset ipsSpacer_top ipsSpacer_half'>\n\t\t\t\t<em class='cContentMessage_author ipsType_light'>\nCONTENT;\n\n$sprintf = array($member->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'content_item_message', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/em>\n\t\t\t<\/p>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction contentItemMessages( $messages, $item ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $messages AS $id => $message ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->contentItemMessage( $message, $item, $id );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction controlStrip( $buttons ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<ul class='ipsControlStrip ipsType_noBreak ipsList_reset' data-ipsControlStrip>\n\t\nCONTENT;\n\nforeach ( $buttons as $button ):\n$return .= <<<CONTENT\n\n\t\t<li class='ipsControlStrip_button \nCONTENT;\n\nif ( isset( $button['hidden'] ) and $button['hidden'] ):\n$return .= <<<CONTENT\nipsJS_hide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( isset( $button['id'] ) ):\n$return .= <<<CONTENT\nid=\"\nCONTENT;\n$return .= htmlspecialchars( $button['id'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t<a\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['link'] ) ):\n$return .= <<<CONTENT\nhref='\nCONTENT;\n$return .= htmlspecialchars( $button['link'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\ttitle='\nCONTENT;\n\n$val = \"{$button['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'\n\t\t\t\tdata-ipsTooltip\n\t\t\t\taria-label=\"\nCONTENT;\n\n$val = \"{$button['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"\n\t\t\t\t\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['class'] ) ):\n$return .= <<<CONTENT\nclass='\nCONTENT;\n$return .= htmlspecialchars( $button['class'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['data'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $button['data'] as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\tdata-\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['hotkey'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\tdata-keyAction='\nCONTENT;\n$return .= htmlspecialchars( $button['hotkey'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( isset( $button['target'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\ttarget=\"\nCONTENT;\n$return .= htmlspecialchars( $button['target'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\n\t\t\t\t\t\nCONTENT;\n\nif ( $button['target'] == '_blank' ):\n$return .= <<<CONTENT\n rel=\"noopener\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t>\n\t\t\t\t<i class='ipsControlStrip_icon fa fa-\nCONTENT;\n$return .= htmlspecialchars( $button['icon'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i>\n\t\t\t\t<span class='ipsControlStrip_item'>\nCONTENT;\n\n$val = \"{$button['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/a>\n\t\t<\/li>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/ul>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction coverPhoto( $url, $coverPhoto ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='ipsPageHead_special ipsCoverPhoto' data-controller='core.global.core.coverPhoto' data-url=\"\nCONTENT;\n$return .= htmlspecialchars( $url->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-coverOffset='\nCONTENT;\n$return .= htmlspecialchars( $coverPhoto->offset, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\n$cfObject = $coverPhoto->object;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $coverPhoto->file ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsCoverPhoto_container'>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->lazy_load_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\t<img src='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Text\\Parser::blankImage(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-src='\nCONTENT;\n$return .= htmlspecialchars( $coverPhoto->file->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsCoverPhoto_photo' data-action=\"toggleCoverPhoto\" alt=''>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $coverPhoto->file->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsCoverPhoto_photo' data-action=\"toggleCoverPhoto\" alt=''>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nelseif ( ! empty( $cfObject::$coverPhotoDefault ) ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsCoverPhoto_container' style=\"background-color: \nCONTENT;\n$return .= htmlspecialchars( $coverPhoto->object->coverPhotoBackgroundColor(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t<img src='\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"pattern.png\", \"core\", 'global', false );\n$return .= <<<CONTENT\n' class='ipsCoverPhoto_photo' data-action=\"toggleCoverPhoto\" alt=''>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$id = mt_rand();\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $coverPhoto->editable ):\n$return .= <<<CONTENT\n\n\t\t<a href='#elEditPhoto\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' data-hideOnCoverEdit class='ipsCoverPhoto_button ipsPos_right ipsButton ipsButton_verySmall ipsButton_narrow ipsButton_overlaid' data-ipsMenu id='elEditPhoto\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role='coverPhotoOptions'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div class='ipsColumns ipsColumns_collapsePhone' data-hideOnCoverEdit>\n\t\t<div class='ipsColumn ipsColumn_fluid'>\n\t\t\t\nCONTENT;\n\nif ( $coverPhoto->editable ):\n$return .= <<<CONTENT\n\n\t\t\t\t<ul class='ipsMenu ipsMenu_auto ipsHide' id='elEditPhoto\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $coverPhoto->file ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class='ipsMenu_item' data-role='photoEditOption'>\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( array( 'do' => 'coverPhotoRemove' ) )->csrf()->addRef( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='removeCoverPhoto'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_remove', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li class='ipsMenu_item ipsHide' data-role='photoEditOption'>\n\t\t\t\t\t\t\t<a href='#' data-action='positionCoverPhoto'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_reposition', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsMenu_item'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( array( 'do' => 'coverPhotoUpload' ) )->addRef( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_add', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_add', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t<\/ul>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t{$coverPhoto->overlay}\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction customFieldsDisplay( $author ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $author->contentProfileFields() as $group => $fields ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nforeach ( $fields as $field => $value ):\n$return .= <<<CONTENT\n\n\t<li class='ipsResponsive_hidePhone ipsType_break'>\n\t\t{$value}\n\t<\/li>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction designersModeBuilding( $html, $title=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<!DOCTYPE html>\n<html lang=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->bcp47(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" dir=\"\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->isrtl ):\n$return .= <<<CONTENT\nrtl\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nltr\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t<head>\n\t\t<title>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->getTitle( $title ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/title>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeMeta(  );\n$return .= <<<CONTENT\n\n\t<style type=\"text\/css\">\n\t\t\/* ======================================================== *\/\n\/* PROGRESS BAR *\/\n@keyframes progress-bar-stripes {\n\tfrom { background-position: 40px 0; }\n\tto { background-position: 0 0; }\n}\n\n.ipsProgressBar {\n\twidth: 50%;\n\tmargin: auto;\n\theight: 26px;\n\toverflow: hidden;\n\tbackground: rgb(156,156,156);\n\tbackground: linear-gradient(to bottom, rgba(156,156,156,1) 0%,rgba(180,180,180,1) 100%);\n\tborder-radius: 4px;\n\tbox-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n\t\n\t.ipsProgressBar.ipsProgressBar_fullWidth {\n\t\twidth: 100%;\n\t}\n\n\t.ipsProgressBar.ipsProgressBar_animated .ipsProgressBar_progress {\n\t\tbackground-color: #5490c0;\n\t\tbackground-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);\n\t\tbackground-size: 40px 40px;\n\t}\n\n.ipsProgressBar_progress {\n\tfloat: left;\n\twidth: 0;\n\theight: 100%;\n\tfont-size: 12px;\n\tfont-weight: bold;\n\tcolor: #ffffff;\n\ttext-align: center;\n\ttext-shadow: 1px 1px 0 rgba(0, 0, 0, 0.25);\n\tbackground: #5490c0;\n\tposition: relative;\n\twhite-space: nowrap;\n\tline-height: 26px;\n}\n\t\n\t.ipsProgressBar_warning .ipsProgressBar_progress {\n\t\tbackground: #8c3737;\n\t}\n\n\t.ipsProgressBar > span:first-child {\n\t\tpadding-left: 7px;\n\t}\n\n\t.ipsProgressBar_progress[data-progress]:after {\n\t\tposition: absolute;\n\t\tright: 5px;\n\t\ttop: 0;\n\t\tline-height: 32px;\n\t\tcolor: #fff;\n\t\tcontent: attr(data-progress);\n\t\tdisplay: block;\n\t\tfont-weight: bold;\n\t}\n\t\n\tspan[data-role=message] {\n\t\ttext-align: center;\n\t\tdisplay: block;\n\t\tmargin: 8px;\n\t\tfont-family: Helvetica;\n\t}\n\n\t<\/style>\n\t<\/head>\n\t<body class=\"ipsApp ipsApp_front ipsJS_none ipsClearfix ipsLayout_noBackground\">\n\t\t{$html}\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeJS(  );\n$return .= <<<CONTENT\n\n\t<\/body>\n<\/html>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction embedComment( $item, $comment, $url, $image=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\n$useImage = NULL;\n$return .= <<<CONTENT\n\n<div data-embedInfo-maxSize='\nCONTENT;\n\nif ( \\IPS\\Settings::i()->max_internalembed_width ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->max_internalembed_width;\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n100%\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' class='ipsRichEmbed'>\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"embed\", \"core\" )->embedHeader( $comment, \\IPS\\Member::loggedIn()->language()->addToStack( 'embed_comment_on', FALSE, array( 'sprintf' => array( $comment->author()->name ) ) ), $comment->mapped('date'), $url );\n$return .= <<<CONTENT\n\n\t<div class='ipsPad_double'>\n\t\t<div class='ipsRichEmbed_originalItem ipsAreaBackground_reset ipsSpacer_bottom ipsType_blendLinks'>\n\t\t\t<div>\n\t\t\t\t\nCONTENT;\n\nif ( $image ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$useImage = $image;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelseif ( $contentImage = $item->contentImages(1) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$attachType = key( $contentImage[0] );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$useImage = \\IPS\\File::get( $attachType, $contentImage[0][ $attachType ] );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\nCONTENT;\n\nif ( $useImage ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class='ipsRichEmbed_masthead ipsRichEmbed_mastheadBg ipsType_center'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' style='background-image: url( \"\nCONTENT;\n\n$return .= htmlspecialchars( str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $useImage->url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" )'>\n\t\t\t\t\t\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $useImage->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsHide' alt=''>\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t<div class='ipsPad'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"embed\", \"core\" )->embedOriginalItem( $item );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\n\t\t<div class='ipsType_richText ipsType_medium' data-truncate='3'>\n\t\t\t{$comment->truncated(TRUE)}\n\t\t<\/div>\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_enabled and \\IPS\\IPS::classUsesTrait( $comment, 'IPS\\Content\\Reactable' ) and \\count( $comment->reactions() ) ):\n$return .= <<<CONTENT\n\n\t\t\t<ul class='ipsList_inline ipsSpacer_top ipsSpacer_half'>\n\t\t\t\t<li>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reactionOverview( $comment, TRUE, 'small' );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/li>\n\t\t\t<\/ul>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction embedExternal( $output, $js ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<!DOCTYPE html>\n<html lang=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->bcp47(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" dir=\"\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->isrtl ):\n$return .= <<<CONTENT\nrtl\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nltr\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t<head>\n\t\t<script type='text\/javascript'>\n\t\t\tvar ipsDebug = \nCONTENT;\n\nif ( ( \\IPS\\IN_DEV and \\IPS\\DEV_DEBUG_JS ) or \\IPS\\DEBUG_JS ):\n$return .= <<<CONTENT\ntrue\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfalse\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n;\n\t\t<\/script>\n\t\t\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeCSS(  );\n$return .= <<<CONTENT\n\n\n\t\t\nCONTENT;\n\nif ( \\is_array( $js ) ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $js as $jsInclude ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$filename = \\IPS\\Http\\Url::external( $jsInclude[0] );\n$return .= <<<CONTENT\n\n\t\t\t\t<script type='text\/javascript' src='\nCONTENT;\n$return .= htmlspecialchars( $filename, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/script>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/head>\n\t<body class='unloaded \nCONTENT;\n\nif ( isset( \\IPS\\Request::i()->cookie['hasJS'] ) ):\n$return .= <<<CONTENT\nipsJS_has\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsJS_none\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-role='externalEmbed'>\n\t\t<div id='ipsEmbed'>\n\t\t\t{$output}\n\t\t<\/div>\n\t\t<div id='ipsEmbedLoading'>\n\t\t\t<span><\/span>\n\t\t<\/div>\n\t<\/body>\n<\/html>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction embedInternal( $html, $js ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<!DOCTYPE html>\n<html lang=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->bcp47(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" dir=\"\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->isrtl ):\n$return .= <<<CONTENT\nrtl\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nltr\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t<head>\n\t\t<title>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/title>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeMeta(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeCSS(  );\n$return .= <<<CONTENT\n\n\n\t\t<script type='text\/javascript'>\n\t\t\tvar ipsDebug = \nCONTENT;\n\nif ( ( \\IPS\\IN_DEV and \\IPS\\DEV_DEBUG_JS ) or \\IPS\\DEBUG_JS ):\n$return .= <<<CONTENT\ntrue\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfalse\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n;\n\t\t<\/script>\n\n\t\t\nCONTENT;\n\nif ( \\is_array( $js ) ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $js as $jsInclude ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$filename = \\IPS\\Http\\Url::external( $jsInclude[0] );\n$return .= <<<CONTENT\n\n\t\t\t\t<script type='text\/javascript' src='\nCONTENT;\n$return .= htmlspecialchars( $filename, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/script>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/head>\n\t<body class='unloaded ipsApp ipsApp_front ipsClearfix ipsLayout_noBackground \nCONTENT;\n\nif ( isset( \\IPS\\Request::i()->cookie['hasJS'] ) ):\n$return .= <<<CONTENT\nipsJS_has\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsJS_none\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsClearfix\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->bodyClasses as $class ):\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $class, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n' data-role='internalEmbed' \nCONTENT;\n\nif ( \\IPS\\Dispatcher::i()->application ):\n$return .= <<<CONTENT\ndata-pageapp='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Dispatcher::i()->application->directory, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( \\IPS\\Dispatcher::i()->module ):\n$return .= <<<CONTENT\ndata-pagemodule='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Dispatcher::i()->module->key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-pagecontroller='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Dispatcher::i()->controller, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t<div id='ipsEmbed'>\n\t\t\t{$html}\n\t\t<\/div>\n\t\t<div id='ipsEmbedLoading'>\n\t\t\t<span><\/span>\n\t\t<\/div>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Output::i()->endBodyCode;\n$return .= <<<CONTENT\n\n\t<\/body>\n<\/html>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction embedItem( $item, $url, $image=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div data-embedInfo-maxSize='\nCONTENT;\n\nif ( \\IPS\\Settings::i()->max_internalembed_width ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->max_internalembed_width;\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n100%\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' class='ipsRichEmbed'>\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"embed\", \"core\" )->embedHeader( $item, \\IPS\\Member::loggedIn()->language()->addToStack( 'embed_posted_item', FALSE, array( 'sprintf' => array( $item->author()->name, $item->container()->_title ) ) ), $item->mapped('date'), $url );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $image ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$useImage = $image;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nelseif ( $contentImage = $item->contentImages(1) ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$attachType = key( $contentImage[0] );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$useImage = \\IPS\\File::get( $attachType, $contentImage[0][ $attachType ] );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\nCONTENT;\n\nif ( $useImage ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsRichEmbed_masthead ipsRichEmbed_mastheadBg ipsType_center'>\n\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' style='background-image: url( \"\nCONTENT;\n\n$return .= htmlspecialchars( str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $useImage->url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" )'>\n\t\t\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $useImage->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsHide' alt=''>\n\t\t\t<\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div class='ipsPad_double ipsClearfix'>\n\t\t<p class='ipsRichEmbed_itemTitle ipsType_reset ipsTruncate ipsTruncate_line ipsType_blendLinks'>\n\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $item->mapped('title'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/p>\n\t\t\nCONTENT;\n\nif ( $desc = $item->truncated(TRUE) ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsType_richText ipsType_medium ipsSpacer_top ipsSpacer_half' data-truncate='3'>\n\t\t\t\t{$desc}\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"embed\", \"core\" )->embedItemStats( $item );\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction embedReview( $item, $review, $url, $image=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\n$useImage = NULL;\n$return .= <<<CONTENT\n\n<div data-embedInfo-maxSize='\nCONTENT;\n\nif ( \\IPS\\Settings::i()->max_internalembed_width ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->max_internalembed_width;\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n100%\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' class='ipsRichEmbed'>\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"embed\", \"core\" )->embedHeader( $comment, \\IPS\\Member::loggedIn()->language()->addToStack( 'embed_review_of', FALSE, array( 'sprintf' => array( $comment->author()->name ) ) ), $comment->mapped('date'), $url );\n$return .= <<<CONTENT\n\n\t<div class='ipsPad_double'>\n\t\t<div class='ipsRichEmbed_originalItem ipsAreaBackground_reset ipsSpacer_bottom ipsType_blendLinks'>\n\t\t\t<div>\n\t\t\t\t\nCONTENT;\n\nif ( $image ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$useImage = $image;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelseif ( $contentImage = $item->contentImages(1) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$attachType = key( $contentImage[0] );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$useImage = \\IPS\\File::get( $attachType, $contentImage[0][ $attachType ] );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\nCONTENT;\n\nif ( $useImage ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class='ipsRichEmbed_masthead ipsRichEmbed_mastheadBg ipsType_center'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' style='background-image: url( \"\nCONTENT;\n\n$return .= htmlspecialchars( str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $useImage->url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" )'>\n\t\t\t\t\t\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $useImage->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsHide' alt=''>\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t<div class='ipsPad'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"embed\", \"core\" )->embedOriginalItem( $item );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->rating( 'veryLarge', $comment->mapped('rating') );\n$return .= <<<CONTENT\n \n\t\t\nCONTENT;\n\nif ( $comment->mapped('votes_total') ):\n$return .= <<<CONTENT\n\n\t\t\t<p class='ipsType_reset ipsType_medium'>{$comment->helpfulLine()}<\/p>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<hr class='ipsHr'>\n\t\t<div class='ipsType_richText ipsType_medium ipsSpacer_top ipsSpacer_half' data-truncate='3'>\n\t\t\t{$comment->truncated(TRUE)}\n\t\t<\/div>\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_enabled and \\IPS\\IPS::classUsesTrait( $comment, 'IPS\\Content\\Reactable' ) and \\count( $comment->reactions() ) ):\n$return .= <<<CONTENT\n\n\t\t\t<ul class='ipsList_inline ipsSpacer_top ipsSpacer_half'>\n\t\t\t\t<li>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reactionOverview( $comment, TRUE, 'small' );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/li>\n\t\t\t<\/ul>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction error( $title, $message, $code, $extra, $member, $faultyPluginOrApp=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<section id='elError' class='ipsType_center'>\n\t<div class='ipsBox ipsPad'>\n\t\t<i class='fa fa-exclamation-circle ipsType_huge'><\/i>\n\t\t<p class='ipsType_reset ipsType_light ipsType_large'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'something_went_wrong', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/p>\n\t\t<div id='elErrorMessage' class='ipsPos_center'>\n\t\t\t{$message}\n\t\t<\/div>\n\t\t<p class='ipsType_light ipsType_reset ipsType_normal'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'error_page_code', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <strong>\nCONTENT;\n$return .= htmlspecialchars( $code, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/strong>\n\t\t<\/p>\n\t\t\nCONTENT;\n\nif ( ( \\IPS\\IN_DEV or $member->isAdmin() ) and $extra ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $faultyPluginOrApp ):\n$return .= <<<CONTENT\n\n\t\t\t<p class=\"ipsType_reset  ipsType_large ipsPos_center\">\n\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $faultyPluginOrApp, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t<div class=\"ipsPad ipsType_left\">\n\t\t\t\t<h3 class=\"ipsType_minorHeading\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'error_technical_details', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t<textarea rows=\"13\" style=\"font-family: monospace;\">\nCONTENT;\n$return .= htmlspecialchars( $extra, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/textarea>\n\t\t\t\t<p class=\"ipsType_small ipsType_light\">\n\t\t\t\t\t\nCONTENT;\n\nif ( $member->isAdmin() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'error_technical_details_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $member->hasAcpRestriction( 'core', 'support', 'system_logs_view' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'error_technical_details_logs', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelseif ( \\IPS\\IN_DEV ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'error_technical_details_dev', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/p>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( ( \\IPS\\Member::loggedIn()->isAdmin() and \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'support', 'get_support' ) ) || ( \\IPS\\Member::loggedIn()->canUseContactUs() and !( \\IPS\\Dispatcher::i()->application->directory == 'core' and \\IPS\\Dispatcher::i()->module and \\IPS\\Dispatcher::i()->module->key == 'contact' ) ) || !\\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t<hr class='ipsHr'>\n\n\t\t<ul class='ipsList_inline'>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->isAdmin() and \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'support', 'get_support' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li>\n\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=support&controller=support\", \"admin\", \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'get_support', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_light ipsButton_medium'>\n\t\t\t\t\t\t<i class=\"fa fa-lock\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'get_support', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nelseif ( \\IPS\\Member::loggedIn()->canUseContactUs() and !( \\IPS\\Dispatcher::i()->application->directory == 'core' and \\IPS\\Dispatcher::i()->module and \\IPS\\Dispatcher::i()->module->key == 'contact' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li>\n\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=contact&controller=contact\", null, \"contact\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'contact_admin', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_light ipsButton_medium'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'contact_admin', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li>\n\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_medium' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/section>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction favico(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->icons_favicon ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$file = \\IPS\\File::get( 'core_Icons', \\IPS\\Settings::i()->icons_favicon );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\File::getMimeType( $file->originalFilename ) == 'image\/x-icon' ):\n$return .= <<<CONTENT\n\n\t\t<link rel='shortcut icon' href='\nCONTENT;\n$return .= htmlspecialchars( $file->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' type=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\File::getMimeType( $file->originalFilename ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$dimensions = $file->getImageDimensions();\n$return .= <<<CONTENT\n\n\t\t<link rel='shortcut icon' href='\nCONTENT;\n$return .= htmlspecialchars( $file->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' type=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\File::getMimeType( $file->originalFilename ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" sizes=\"\nCONTENT;\n$return .= htmlspecialchars( $dimensions[0], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\nx\nCONTENT;\n$return .= htmlspecialchars( $dimensions[1], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction featuredComment( $comment, $id, $commentLang='__defart_comment' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( isset( $comment['comment'] ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$idField = $comment['comment']::$databaseColumnId;\n$return .= <<<CONTENT\n\n\t<div class='ipsBox ipsPad ipsClearfix ipsComment_recommended ipsSpacer_bottom' data-commentID='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t<span class='ipsComment_recommendedFlag'><i class='fa fa-star'><\/i><span class='ipsResponsive_hidePhone'> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recommended', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span><\/span>\n\t\t<div class='ipsColumns ipsColumns_collapsePhone'>\n\t\t\t<aside class='ipsType_center ipsColumn ipsColumn_narrow'>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $comment['comment']->author(), 'small', $comment['comment']->warningRef() );\n$return .= <<<CONTENT\n\n\t\t\t<\/aside>\n\t\t\t<div class='ipsColumn ipsColumn_fluid ipsType_blendLinks'>\n\t\t\t\t<p class='ipsComment_meta ipsSpacer_bottom ipsSpacer_half ipsType_light'>\n\t\t\t\t\t\nCONTENT;\n\n$htmlsprintf = array($comment['comment']->author()->link( $comment['comment']->warningRef() ), \\IPS\\DateTime::ts( $comment['comment']->mapped('date') )->html(FALSE)); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'posted_by_x', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/p>\n\t\t\t\t<div class='ipsType_richText ipsType_normal' data-ipsTruncate data-ipsTruncate-type='remove' data-ipsTruncate-size='2 lines'>{$comment['comment']->truncated( TRUE )}<\/div>\n\t\n\t\t\t\t\nCONTENT;\n\nif ( $comment['note'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class='ipsComment_recommendedNote ipsType_medium'>\n\t\t\t\t\t\t<p class='ipsType_reset ipsType_richText'>\nCONTENT;\n$return .= htmlspecialchars( $comment['note'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $comment['featured_by'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<p class='ipsType_reset ipsType_light'>\nCONTENT;\n\n$htmlsprintf = array($comment['featured_by']->link()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recommended_by', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nelseif ( isset( $comment['featured_by'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$htmlsprintf = array($comment['featured_by']->link()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recommended_by', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\t<div class='ipsColumn ipsColumn_medium'>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\IPS::classUsesTrait( $comment['comment'], 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reactionOverview( $comment['comment'] );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<hr class='ipsHr'>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $comment['comment']->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='goToComment' class='ipsButton ipsButton_link ipsButton_verySmall ipsButton_fullWidth'>\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->get( $commentLang )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_to_this_comment', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n <i class='fa fa-angle-right'><\/i><\/a>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction featuredComments( $comments, $url, $titleLang='recommended_replies', $commentLang='__defart_comment' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div data-controller='core.front.core.recommendedComments' data-url='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsAreaBackground ipsPad ipsBox ipsBox_transparent ipsSpacer_bottom ipsRecommendedComments \nCONTENT;\n\nif ( !\\count( $comments ) ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t<div data-role=\"recommendedComments\">\n\t\t<h2 class='ipsType_sectionHead ipsType_large'>\nCONTENT;\n\n$val = \"{$titleLang}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\nCONTENT;\n\nif ( \\count( $comments ) ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $comments AS $id => $comment ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->featuredComment( $comment, $id, $commentLang );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction findComment( $header, $item, $comment ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$idField = $comment::$databaseColumnId;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$itemClassSafe = str_replace( '\\\\', '_', mb_substr( $comment::$itemClass, 4 ) );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( ! \\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\n\n\t<h1 class='ipsType_pageTitle'><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $item->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $comment->$idField ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlspecialchars( $header, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/h1>\n\t<br \/>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<article id='elComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsComment \nCONTENT;\n\nif ( \\IPS\\IPS::classUsesTrait( $comment, 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_highlight and $comment->reactionCount() >= \\IPS\\Settings::i()->reputation_highlight ):\n$return .= <<<CONTENT\nipsComment_popular\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsComment_parent ipsClearfix ipsClear \nCONTENT;\n\nif ( $comment->hidden() ):\n$return .= <<<CONTENT\nipsModerated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t<div id='comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap' data-controller='core.front.core.comment' data-commentApp='\nCONTENT;\n$return .= htmlspecialchars( $comment::$application, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-commentType='\nCONTENT;\n$return .= htmlspecialchars( $item::$module, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-commentID=\"\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-quoteData='\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( array('userid' => $comment->author()->member_id, 'username' => $comment->author()->name, 'timestamp' => $comment->mapped('date'), 'contentapp' => $comment::$application, 'contenttype' => $item::$module, 'contentclass' => $itemClassSafe, 'contentid' => $item->id, 'contentcommentid' => $comment->$idField) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsComment_content ipsType_medium'>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_enabled and \\IPS\\IPS::classUsesTrait( $comment, 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_highlight and $comment->reactionCount() >= \\IPS\\Settings::i()->reputation_highlight ):\n$return .= <<<CONTENT\n\n\t\t\t<strong class='ipsComment_popularFlag' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_a_popular_comment', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-heart'><\/i><\/strong>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\n\t\t<div class='ipsComment_header ipsPhotoPanel ipsPhotoPanel_mini ipsPhotoPanel_notPhone'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $comment->author(), 'mini', $comment->warningRef() );\n$return .= <<<CONTENT\n\n\t\t\t<div>\n\t\t\t\t<h3 class='ipsComment_author ipsType_blendLinks'>\n\t\t\t\t\t<strong class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLink( $comment->author(), $comment->warningRef() );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t<\/h3>\n\t\t\t\t<p class='ipsComment_meta ipsType_light ipsType_medium'>\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $comment->id ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsType_blendLinks'>{$comment->dateLine()}<\/a>\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->editLine() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t&middot; {$comment->editLine()}\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t&middot; \nCONTENT;\n$return .= htmlspecialchars( $comment->hiddenBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/p>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->modPermission('mod_see_warn') and $comment->warning ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->commentWarned( $comment );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class='ipsAreaBackground_reset ipsPad'>\t\t\t\n\t\t\t<div data-role='commentContent' class='ipsType_richText ipsContained' data-controller='core.front.core.lightboxedImages'>\n\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() === 1 && $comment->author()->member_id == \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<strong class='ipsType_medium ipsType_warning'><i class='fa fa-info-circle'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'comment_awaiting_approval', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t{$comment->content()}\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nif ( $comment->hidden() !== 1 && \\IPS\\IPS::classUsesTrait( $comment, 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\t<br>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reputation( $comment );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n<\/article>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction follow( $app, $area, $id, $count ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div data-followApp='\nCONTENT;\n$return .= htmlspecialchars( $app, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-followArea='\nCONTENT;\n$return .= htmlspecialchars( $area, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-followID='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-controller='core.front.core.followButton'>\n\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t<span class='ipsType_light ipsType_blendLinks ipsResponsive_hidePhone ipsResponsive_inline'><i class='fa fa-info-circle'><\/i> <a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'follow_sign_in', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>&nbsp;&nbsp;<\/span>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->followButton( $app, $area, $id, $count );\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction followButton( $app, $area, $id, $count ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->following( $app, $area, $id ) ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsFollow ipsButton ipsButton_primary ipsButton_verySmall\" data-role=\"followButton\" data-following=\"true\">\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=follow&follow_app={$app}&follow_area={$area}&follow_id={$id}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'following_this_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class=\"ipsType_blendLinks ipsType_noUnderline\" data-ipsHover data-ipsHover-cache='false' data-ipsHover-onClick><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'following_this', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t<a class='ipsCommentCount' href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=followers&follow_app={$app}&follow_area={$area}&follow_id={$id}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'followers_tooltip', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'who_follows_this', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $count, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\t\n\t\t<div class=\"ipsFollow ipsButton ipsButton_link ipsButton_verySmall\" data-role=\"followButton\" data-following=\"false\">\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=follow&follow_app={$app}&follow_area={$area}&follow_id={$id}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'follow_this_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class=\"ipsType_blendLinks ipsType_noUnderline\" data-ipsHover data-ipsHover-cache='false' data-ipsHover-onClick>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'follow', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nif ( $count > 0 ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a class='ipsCommentCount' href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=followers&follow_app={$app}&follow_area={$area}&follow_id={$id}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'followers_tooltip', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'who_follows_this', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $count, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='ipsCommentCount'>\nCONTENT;\n$return .= htmlspecialchars( $count, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<div class=\"ipsFollow ipsPos_middle ipsButton ipsButton_link ipsButton_verySmall \nCONTENT;\n\nif ( $count == 0 ):\n$return .= <<<CONTENT\nipsButton_disabled\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-role=\"followButton\">\n\t\t\nCONTENT;\n\nif ( $count > 0 ):\n$return .= <<<CONTENT\n\n\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=followers&follow_app={$app}&follow_area={$area}&follow_id={$id}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'followers_tooltip', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsType_blendLinks ipsType_noUnderline' data-ipsTooltip data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'who_follows_this', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'followers', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<a class='ipsCommentCount' href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=followers&follow_app={$app}&follow_area={$area}&follow_id={$id}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'followers_tooltip', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'who_follows_this', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $count, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<span>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'followers', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<span class='ipsCommentCount'>\nCONTENT;\n$return .= htmlspecialchars( $count, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction footer(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->site_social_profiles AND $links = json_decode( \\IPS\\Settings::i()->site_social_profiles, TRUE ) AND \\count( $links ) ):\n$return .= <<<CONTENT\n\n<ul id='elFooterSocialLinks' class='ipsList_inline ipsType_center ipsSpacer_top'>\n\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['social_links'] == 'footer' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->siteSocialProfiles(  );\nendif;\n$return .= <<<CONTENT\n\n<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( ( \\IPS\\Settings::i()->site_online || \\IPS\\Member::loggedIn()->group['g_access_offline'] ) and ( \\IPS\\Dispatcher::i()->application instanceof \\IPS\\Application AND \\IPS\\Dispatcher::i()->application->canAccess() ) ):\n$return .= <<<CONTENT\n\n<ul class='ipsList_inline ipsType_center ipsSpacer_top' id=\"elFooterLinks\">\n\t\nCONTENT;\n\n$languages = \\IPS\\Lang::getEnabledLanguages();\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\count( $languages ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t<li>\n\t\t\t<a href='#elNavLang_menu' id='elNavLang' data-ipsMenu data-ipsMenu-above>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'language', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t<ul id='elNavLang_menu' class='ipsMenu ipsMenu_selectable ipsHide'>\n\t\t\t\nCONTENT;\n\nforeach ( $languages as $id => $lang  ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsMenu_item\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->id == $id || ( $lang->default && \\IPS\\Member::loggedIn()->language === 0 ) ):\n$return .= <<<CONTENT\n ipsMenu_itemChecked\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<form action=\"\nCONTENT;\n\n$return .= str_replace( array( 'http:\/\/', 'https:\/\/' ), '\/\/', htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=language\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"language\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE ) );\n$return .= <<<CONTENT\n\" method=\"post\">\n\t\t\t\t\t<input type=\"hidden\" name=\"ref\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( base64_encode( (string) \\IPS\\Request::i()->url() ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<button type='submit' name='id' value='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_link ipsButton_link_secondary'>\nCONTENT;\n\nif ( $lang->get__icon() ):\n$return .= <<<CONTENT\n<i class='\nCONTENT;\n$return .= htmlspecialchars( $lang->get__icon(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i> \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $lang->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $lang->default ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'default', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/button>\n\t\t\t\t\t<\/form>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$themes = \\IPS\\Theme::getThemesWithAccessPermission();\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\count( $themes ) > 1  ):\n$return .= <<<CONTENT\n\n\t\t<li>\n\t\t\t<a href='#elNavTheme_menu' id='elNavTheme' data-ipsMenu data-ipsMenu-above>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'skin', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t<ul id='elNavTheme_menu' class='ipsMenu ipsMenu_selectable ipsHide'>\n\t\t\t\nCONTENT;\n\nforeach ( $themes as $id => $set  ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsMenu_item\nCONTENT;\n\nif ( \\IPS\\Theme::i()->id == $id ):\n$return .= <<<CONTENT\n ipsMenu_itemChecked\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<form action=\"\nCONTENT;\n\n$return .= str_replace( array( 'http:\/\/', 'https:\/\/' ), '\/\/', htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=theme\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"theme\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE ) );\n$return .= <<<CONTENT\n\" method=\"post\">\n\t\t\t\t\t<input type=\"hidden\" name=\"ref\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( base64_encode( (string) \\IPS\\Request::i()->url() ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<button type='submit' name='id' value='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_link ipsButton_link_secondary'>\nCONTENT;\n\n$val = \"{$set->_title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $set->is_default ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'default', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/button>\n\t\t\t\t\t<\/form>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->privacy_type != \"none\" ):\n$return .= <<<CONTENT\n\n\t\t<li><a href='\nCONTENT;\n\nif ( \\IPS\\Settings::i()->privacy_type == \"internal\" ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=privacy\", null, \"privacy\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->privacy_link;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'privacy', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canUseContactUs() and !( \\IPS\\Dispatcher::i()->application->directory == 'core' and \\IPS\\Dispatcher::i()->module and \\IPS\\Dispatcher::i()->module->key == 'contact' ) ):\n$return .= <<<CONTENT\n\n\t\t<li><a rel=\"nofollow\" href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=contact&controller=contact\", null, \"contact\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Settings::i()->contact_type != 'contact_redirect'  ):\n$return .= <<<CONTENT\ndata-ipsdialog data-ipsDialog-remoteSubmit data-ipsDialog-flashMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'contact_sent_blurb', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'contact', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'contact', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/ul>\t\n\nCONTENT;\n\nif ( \\IPS\\Dispatcher::i()->application instanceof \\IPS\\Application AND \\IPS\\Dispatcher::i()->application->canManageWidgets() ):\n$return .= <<<CONTENT\n\n\t<button type='button' id='elWidgetControls' data-action='openSidebar' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'manage_blocks', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_narrow'><i class='fa fa-chevron-right'><\/i><\/button>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<p id='elCopyright'>\n\t<span id='elCopyright_userLine'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'copyright_line_value', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\nCONTENT;\n\nif ( !$licenseData = \\IPS\\IPS::licenseKey() or !isset($licenseData['products']['copyright']) or !$licenseData['products']['copyright'] ):\n$return .= <<<CONTENT\n<a rel='nofollow' title='Invision Community' href='https:\/\/www.invisioncommunity.com\/'>Powered by Invision Community<\/a>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/p>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction formattedInlineStyle( $item ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\is_array($item) ):\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $item['feature_color'] ):\n$return .= <<<CONTENT\nstyle=\"background-color: \nCONTENT;\n$return .= htmlspecialchars( $item['feature_color'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n; color: \nCONTENT;\n$return .= htmlspecialchars( $item['text_color'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n;\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$column = $item::$featureColumnName;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $item->$column ):\n$return .= <<<CONTENT\nstyle=\"background-color: \nCONTENT;\n$return .= htmlspecialchars( $item->$column, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n; color: \nCONTENT;\n$return .= htmlspecialchars( $item->_featureTextColor, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n;\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction formattedTitle( $item ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\is_array($item) ):\n$return .= <<<CONTENT\n\n<span class=\"ipsBadge ipsBadge_pill\" \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->formattedInlineStyle( $item );\n$return .= <<<CONTENT\n>\nCONTENT;\n$return .= htmlspecialchars( $item['title'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n<span class=\"ipsBadge ipsBadge_pill\" \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->formattedInlineStyle( $item );\n$return .= <<<CONTENT\n>\nCONTENT;\n$return .= htmlspecialchars( $item->_title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction genericBlock( $content, $title='', $classes=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $title ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->pageHeader( $title );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<div class='\nCONTENT;\n\nif ( $classes ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t{$content}\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction globalTemplate( $title,$html,$location=array() ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<!DOCTYPE html>\n<html lang=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->bcp47(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" dir=\"\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->isrtl ):\n$return .= <<<CONTENT\nrtl\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nltr\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t<head>\n\t\t<title>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->getTitle( $title ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/title>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->ipbseo_ga_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->ipseo_ga;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<!--[if lt IE 9]>\n\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Theme::i()->css( 'extra\/ie8.css', 'core' ) as $css ):\n$return .= <<<CONTENT\n<link rel=\"stylesheet\" type=\"text\/css\" href=\"\nCONTENT;\n$return .= htmlspecialchars( $css, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t    <script src=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"applications\/core\/interface\/html5shiv\/html5shiv.js\", \"none\", \"\", array(), \\IPS\\Http\\Url::PROTOCOL_RELATIVE ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\"><\/script>\n\t\t<![endif]-->\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeMeta(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeCSS(  );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['js_include'] != 'footer' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeJS(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->favico(  );\n$return .= <<<CONTENT\n\n\t<\/head>\n\t<body class='ipsApp ipsApp_front \nCONTENT;\n\nif ( isset( \\IPS\\Request::i()->cookie['hasJS'] ) ):\n$return .= <<<CONTENT\nipsJS_has\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsJS_none\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsClearfix\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->bodyClasses as $class ):\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $class, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Output::i()->globalControllers ):\n$return .= <<<CONTENT\ndata-controller='\nCONTENT;\n\n$return .= htmlspecialchars( implode( ',', \\IPS\\Output::i()->globalControllers ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset( \\IPS\\Output::i()->inlineMessage ) ):\n$return .= <<<CONTENT\ndata-message=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->inlineMessage, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-pageApp='\nCONTENT;\n$return .= htmlspecialchars( $location['app'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-pageLocation='front' data-pageModule='\nCONTENT;\n$return .= htmlspecialchars( $location['module'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-pageController='\nCONTENT;\n$return .= htmlspecialchars( $location['controller'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( isset( \\IPS\\Request::i()->id ) ):\n$return .= <<<CONTENT\ndata-pageID='\nCONTENT;\n\n$return .= htmlspecialchars( (int) \\IPS\\Request::i()->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t<a href='#elContent' class='ipsHide' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'jump_to_content_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' accesskey='m'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'jump_to_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<div id='ipsLayout_header' class='ipsClearfix'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->updateWarning(  );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( !\\in_array('ipsLayout_minimal', \\IPS\\Output::i()->bodyClasses ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->mobileNavBar(  );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<header>\n\t\t\t\t<div class='ipsLayout_container'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->logo(  );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( !\\in_array('ipsLayout_minimal', \\IPS\\Output::i()->bodyClasses ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userBar(  );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/header>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->navBar(  );\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t<main id='ipsLayout_body' class='ipsLayout_container'>\n\t\t\t<div id='ipsLayout_contentArea'>\n\t\t\t\t<div id='ipsLayout_contentWrapper'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->breadcrumb( 'top' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['sidebar_position'] == 'left' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->sidebar( 'left' );\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div id='ipsLayout_mainArea'>\n\t\t\t\t\t\t<a id='elContent'><\/a>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\core\\Advertisement::loadByLocation( 'ad_global_header' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->members_bitoptions['unacknowledged_warnings'] ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->acknowledgeWarning( \\IPS\\Member::loggedIn()->warnings( 1, FALSE ) );\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( !\\in_array('ipsLayout_minimal', \\IPS\\Output::i()->bodyClasses ) and !\\IPS\\Member::loggedIn()->members_bitoptions['profile_completion_dismissed'] and $nextStep = \\IPS\\Member::loggedIn()->nextProfileStep() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->profileNextStep( $nextStep, true );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->widgetContainer( 'header', 'horizontal' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t{$html}\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->widgetContainer( 'footer', 'horizontal' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['sidebar_position'] == 'right' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->sidebar( 'right' );\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->breadcrumb( 'bottom' );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->msg_show_notification and $message = \\IPS\\core\\Messenger\\Conversation::latestUnreadMessage() ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->inlineMessage( $message );\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/main>\n\t\t<footer id='ipsLayout_footer' class='ipsClearfix'>\n\t\t\t<div class='ipsLayout_container'>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\core\\Advertisement::loadByLocation( 'ad_global_footer' );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->footer(  );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/footer>\n\t\t\nCONTENT;\n\nif ( !\\in_array('ipsLayout_minimal', \\IPS\\Output::i()->bodyClasses ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['responsive'] ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->mobileNavigation(  );\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->member_id and \\IPS\\Settings::i()->guest_terms_bar ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->guestTermsBar( base64_encode( \\IPS\\Settings::i()->base_url ) );\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['js_include'] == 'footer' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeJS(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->viglink_enabled ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->viglink(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( isset( $_SESSION['live_meta_tags'] ) and $_SESSION['live_meta_tags'] and \\IPS\\Member::loggedIn()->isAdmin() ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->metaTagEditor(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t<!--ipsQueryLog-->\n\t\t<!--ipsCachingLog-->\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Output::i()->endBodyCode;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->fb_pixel_enabled and \\IPS\\Settings::i()->fb_pixel_id and $noscript = \\IPS\\core\\Facebook\\Pixel::i()->noscript() ):\n$return .= <<<CONTENT\n\n\t\t\t<noscript>\n\t\t\t{$noscript}\n\t\t\t<\/noscript>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/body>\n<\/html>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction guestCommentTeaser( $item, $isReview=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div data-controller=\"core.global.core.login\">\n\t<input type=\"hidden\" name=\"csrfKey\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\nCONTENT;\n\nif ( \\IPS\\Login::registrationType() != 'disabled' ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsType_center ipsPad cGuestTeaser'>\n\t\t\t\nCONTENT;\n\nif ( $isReview ):\n$return .= <<<CONTENT\n\n\t\t\t\t<h2 class='ipsType_pageTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_review_title_reg', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t<p class='ipsType_light ipsType_normal ipsType_reset ipsSpacer_top ipsSpacer_half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_review_desc_reg', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<h2 class='ipsType_pageTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_title_reg', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t<p class='ipsType_light ipsType_normal ipsType_reset ipsSpacer_top ipsSpacer_half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_desc_reg', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\n\t\t\t<div class='ipsBox ipsPad ipsSpacer_top'>\n\t\t\t\t<div class='ipsGrid ipsGrid_collapsePhone'>\n\t\t\t\t\t<div class='ipsGrid_span6 cGuestTeaser_left'>\n\t\t\t\t\t\t<h2 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_account', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t\t\t<p class='ipsType_normal ipsType_reset ipsType_light ipsSpacer_bottom'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_account_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Login::registrationType() == 'redirect' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Settings::i()->allow_reg_target, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_small' target=\"_blank\" rel=\"noopener\">\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=register\", null, \"register\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_small' \nCONTENT;\n\nif ( \\IPS\\Login::registrationType() == 'normal' ):\n$return .= <<<CONTENT\ndata-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_account_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class='ipsGrid_span6 cGuestTeaser_right'>\n\t\t\t\t\t\t<h2 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_signin', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t\t\t<p class='ipsType_normal ipsType_reset ipsType_light ipsSpacer_bottom'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_signin_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), 0 )->addRef((string) $item->url() . '#replyForm'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='medium' data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_signin_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class='ipsButton ipsButton_primary ipsButton_small'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_signin_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<div class='ipsType_center ipsPad'>\n\t\t\t<h2 class='ipsType_pageTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_title_noreg', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t<p class='ipsType_light ipsType_normal ipsType_reset ipsSpacer_top ipsSpacer_half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_desc_noreg', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t<br>\n\t\t\t<br>\n\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), 0 )->addRef((string) $item->url() . '#replyForm'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='medium' data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_signin_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class='ipsButton ipsButton_alternate ipsButton_large'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'teaser_signin_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction guestTermsBar( $currentUrl ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$termsLang = \\IPS\\Member::loggedIn()->language()->addToStack( 'terms_of_use' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$privacyLang = \\IPS\\Member::loggedIn()->language()->addToStack( 'terms_privacy' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$glLang = \\IPS\\Member::loggedIn()->language()->addToStack( 'guidelines' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$termsUrl = (string) \\IPS\\Http\\Url::internal( 'app=core&module=system&controller=terms', 'front', 'terms' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$terms = \"<a href='$termsUrl'>$termsLang<\/a>\";\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->privacy_type == 'internal' ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$privacyUrl = (string) \\IPS\\Http\\Url::internal( 'app=core&module=system&controller=privacy', 'front', 'privacy' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$privacyUrl = \\IPS\\Settings::i()->privacy_link;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$privacy = \"<a href='$privacyUrl'>$privacyLang<\/a>\";\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->gl_type == 'internal' ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$glUrl = (string) \\IPS\\Http\\Url::internal( 'app=core&module=system&controller=guidelines', 'front', 'guidelines' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$glUrl = \\IPS\\Settings::i()->gl_link;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$guidelines = \"<a href='$glUrl'>$glLang<\/a>\";\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$cookiesUrl = (string) \\IPS\\Http\\Url::internal( 'app=core&module=system&controller=cookies', 'front', 'cookies' );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$cookies = \\IPS\\Member::loggedIn()->language()->addToStack( 'cookies_message', NULL, array( 'sprintf' => array( $cookiesUrl, $cookiesUrl ) ) );\n$return .= <<<CONTENT\n\n\n<div id='elGuestTerms' class='ipsPad_half ipsJS_hide' data-role='guestTermsBar' data-controller='core.front.core.guestTerms'>\n\t<div class='ipsLayout_container'>\n\t\t<div class='ipsGrid ipsGrid_collapsePhone'>\n\t\t\t<div class='ipsGrid_span10'>\n\t\t\t\t<h2 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'guest_terms_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t<p class='ipsType_reset ipsType_medium cGuestTerms_contents'>\nCONTENT;\n\n$htmlsprintf = array($terms, $privacy, $guidelines, $cookies); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'guest_terms_bar_text_value', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t<\/div>\n\t\t\t<div class='ipsGrid_span2'>\n\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=terms&do=dismiss&ref={$currentUrl}\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' rel='nofollow' class='ipsButton ipsButton_veryLight ipsButton_large ipsButton_fullWidth' data-action='dismissTerms'><i class='fa fa-check'><\/i>&nbsp; \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'guest_terms_close', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction inlineMessage( $message ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elInlineMessage' class='ipsPad' title='\nCONTENT;\n\n$sprintf = array($message->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_inline_title', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'>\n\t<div class='ipsPhotoPanel ipsPhotoPanel_medium'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $message->author(), 'medium' );\n$return .= <<<CONTENT\n\n\t\t<div class='ipsType_normal'>\n\t\t\t<strong>\nCONTENT;\n$return .= htmlspecialchars( $message->item()->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t<span class='ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_inline_date', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\n$val = ( $message->date instanceof \\IPS\\DateTime ) ? $message->date : \\IPS\\DateTime::ts( $message->date );$return .= $val->html();\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<br>\n\t\t\t<div data-ipsTruncate data-ipsTruncate-type=\"remove\" data-ipsTruncate-size=\"3 lines\">\n\t\t\t\t{$message->post}\n\t\t\t<\/div>\n\t\t\t<hr class='ipsHr'>\n\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $message->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_small'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_inline_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->msg_count_new > 1 ):\n$return .= <<<CONTENT\n <a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=messaging&controller=messenger\", null, \"messaging\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_small'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_inline_view_all', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $message->canReportOrRevoke() === TRUE ):\n$return .= <<<CONTENT\n &nbsp;&nbsp; <a href='\nCONTENT;\n$return .= htmlspecialchars( $message->url('report'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><span class='ipsResponsive_showPhone ipsResponsive_inline'><i class='fa fa-flag'><\/i><\/span><span class='ipsResponsive_hidePhone ipsResponsive_inline'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_reply', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span><\/a>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction itemIcon( $iconInfo ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<span class='ipsItemStatus \nCONTENT;\n\nif ( $iconInfo['size'] ):\n$return .= <<<CONTENT\nipsItemStatus_\nCONTENT;\n$return .= htmlspecialchars( $iconInfo['size'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='\nCONTENT;\n\nif ( $iconInfo['type'] == 'unread' ):\n$return .= <<<CONTENT\nfa fa-circle\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><\/i><\/span>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction loginPopup( $login ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elUserSignIn_menu' class='ipsMenu ipsMenu_auto ipsHide'>\n\t<form accept-charset='utf-8' method='post' action='\nCONTENT;\n$return .= htmlspecialchars( $login->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-controller=\"core.global.core.login\">\n\t\t<input type=\"hidden\" name=\"csrfKey\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t<input type=\"hidden\" name=\"ref\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( base64_encode( \\IPS\\Request::i()->url() ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t<div data-role=\"loginForm\">\n\t\t\t\nCONTENT;\n\n$usernamePasswordMethods = $login->usernamePasswordMethods();\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$buttonMethods = $login->buttonMethods();\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $usernamePasswordMethods and $buttonMethods ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsColumns ipsColumns_noSpacing'>\n\t\t\t\t\t<div class='ipsColumn ipsColumn_wide' id='elUserSignIn_internal'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->loginPopupForm( $login );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class='ipsColumn ipsColumn_wide'>\n\t\t\t\t\t\t<div class='ipsPad' id='elUserSignIn_external'>\n\t\t\t\t\t\t\t<div class='ipsAreaBackground_light ipsPad_half'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\count( $buttonMethods ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<p class='ipsType_reset ipsType_small ipsType_center'><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in_with_these', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/p>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $buttonMethods as $method ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<div class='ipsPad_half ipsType_center'>\n\t\t\t\t\t\t\t\t\t\t{$method->button()}\n\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nelseif ( $usernamePasswordMethods ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->loginPopupForm( $login );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelseif ( $buttonMethods ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"cLogin_popupSingle\">\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $buttonMethods as $method ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<div class='ipsPad_half ipsType_center'>\n\t\t\t\t\t\t\t{$method->button()}\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/form>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction loginPopupForm( $login ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class=\"ipsPad ipsForm ipsForm_vertical\">\n\t<h4 class=\"ipsType_sectionHead\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'login', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t<br><br>\n\t<ul class='ipsList_reset'>\n\t\t<li class=\"ipsFieldRow ipsFieldRow_noLabel ipsFieldRow_fullWidth\">\n\t\t\t\nCONTENT;\n\n$authType = $login->authType();\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $authType === \\IPS\\Login::AUTH_TYPE_USERNAME ):\n$return .= <<<CONTENT\n\n\t\t\t\t<input type=\"text\" placeholder=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'username', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" name=\"auth\" autocomplete=\"username\">\n\t\t\t\nCONTENT;\n\nelseif ( $authType === \\IPS\\Login::AUTH_TYPE_EMAIL ):\n$return .= <<<CONTENT\n\n\t\t\t\t<input type=\"email\" placeholder=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'email_address', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" name=\"auth\" autocomplete=\"email\">\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<input type=\"text\" placeholder=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'username_or_email', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" name=\"auth\" autocomplete=\"email\">\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/li>\n\t\t<li class=\"ipsFieldRow ipsFieldRow_noLabel ipsFieldRow_fullWidth\">\n\t\t\t<input type=\"password\" placeholder=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'password', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" name=\"password\" autocomplete=\"current-password\">\n\t\t<\/li>\n\t\t<li class=\"ipsFieldRow ipsFieldRow_checkbox ipsClearfix\">\n\t\t\t<span class=\"ipsCustomInput\">\n\t\t\t\t<input type=\"checkbox\" name=\"remember_me\" id=\"remember_me_checkbox\" value=\"1\" checked aria-checked=\"true\">\n\t\t\t\t<span><\/span>\n\t\t\t<\/span>\n\t\t\t<div class=\"ipsFieldRow_content\">\n\t\t\t\t<label class=\"ipsFieldRow_label\" for=\"remember_me_checkbox\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'remember_me', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/label>\n\t\t\t\t<span class=\"ipsFieldRow_desc\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'remember_me_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/div>\n\t\t<\/li>\n\t\t\nCONTENT;\n\nif ( !\\IPS\\Settings::i()->disable_anonymous ):\n$return .= <<<CONTENT\n\n\t\t\t<li class=\"ipsFieldRow ipsFieldRow_checkbox ipsClearfix\">\n\t\t\t\t<span class=\"ipsCustomInput\">\n\t\t\t\t\t<input type=\"checkbox\" name=\"anonymous\" id=\"anonymous_checkbox\" value=\"1\" aria-checked=\"false\">\n\t\t\t\t\t<span><\/span>\n\t\t\t\t<\/span>\n\t\t\t\t<div class=\"ipsFieldRow_content\">\n\t\t\t\t\t<label class=\"ipsFieldRow_label\" for=\"anonymous_checkbox\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'signin_anonymous', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/label>\n\t\t\t\t<\/div>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<li class=\"ipsFieldRow ipsFieldRow_fullWidth\">\n\t\t\t<br>\n\t\t\t<button type=\"submit\" name=\"_processLogin\" value=\"usernamepassword\" class=\"ipsButton ipsButton_primary ipsButton_small\" id=\"elSignIn_submit\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'login', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/button>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->allow_forgot_password != 'disabled' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<br>\n\t\t\t\t<p class=\"ipsType_right ipsType_small\">\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->allow_forgot_password == 'redirect' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Settings::i()->allow_forgot_password_target, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target=\"_blank\" rel=\"noopener\">\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=lostpass\", null, \"lostpassword\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'forgotten_password', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'forgotten_password', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/li>\n\t<\/ul>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction logo(   ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Theme::i()->logo['front']['url'] !== null  ):\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$logo = \\IPS\\File::get( 'core_Theme', \\IPS\\Theme::i()->logo['front']['url'] )->url;\n$return .= <<<CONTENT\n\n<a href='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\n' id='elLogo' accesskey='1'><img src=\"\nCONTENT;\n$return .= htmlspecialchars( $logo, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" alt='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Settings::i()->board_name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'><\/a>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n<a href='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\n' id='elSiteTitle' accesskey='1'>\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->board_name;\n$return .= <<<CONTENT\n<\/a>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction metaTagEditor(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div id='elMetaTagEditor' class='ipsToolbox ipsPad ipsScrollbar' data-controller=\"core.front.system.metaTagEditor\">\n\t<h3 class='ipsToolbox_title ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'live_meta_tag_editor', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t<form accept-charset='utf-8' method='post' action=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=metatags&do=save\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" data-ipsForm>\n\t\t<input type='hidden' name='meta_url' value='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->metaTagsUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t<input type=\"hidden\" name=\"csrfKey\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\n\t\t<h4 class='ipsToolbox_sectionTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'metatags_page_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t<input name='meta_tag_title' type='text' value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Output::i()->metaTagsTitle, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t<br><br>\n\n\t\t<h4 class='ipsToolbox_sectionTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_tags_blurb', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\n\t\t<ul class='ipsList_reset' id='elMetaTagEditor_tags'>\n\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->metaTags as $name => $content ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li>\n\t\t\t\t\t<ul class='ipsForm ipsForm_vertical'>\n\t\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth'>\n\t\t\t\t\t\t\t<select name='meta_tag_name[]' data-role='metaTagChooser'>\n\t\t\t\t\t\t\t\t<option value='keywords' \nCONTENT;\n\nif ( $name == 'keywords' ):\n$return .= <<<CONTENT\nselected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_keywords', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t\t<option value='description' \nCONTENT;\n\nif ( $name == 'description' ):\n$return .= <<<CONTENT\nselected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_description', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t\t<option value='robots' \nCONTENT;\n\nif ( $name == 'robots' ):\n$return .= <<<CONTENT\nselected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_robots', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t\t<option value='other' \nCONTENT;\n\nif ( !\\in_array( $name, array( 'keywords', 'description', 'robots' ) ) ):\n$return .= <<<CONTENT\nselected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_other', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t<\/select>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth\nCONTENT;\n\nif ( \\in_array( $name, array( 'keywords', 'description', 'robots' ) ) ):\n$return .= <<<CONTENT\n ipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-role='metaTagName'>\n\t\t\t\t\t\t\t<input name='meta_tag_name_other[]' type='text' value=\"\nCONTENT;\n\nif ( !\\in_array( $name, array( 'keywords', 'description', 'robots' ) ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" placeholder='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'metatags_name', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth'>\n\t\t\t\t\t\t\t<input name='meta_tag_content[]' type='text' value=\"\nCONTENT;\n$return .= htmlspecialchars( $content, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" placeholder='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'metatags_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsHide' data-role='metaTemplate'>\n\t\t\t\t<ul class='ipsForm ipsForm_vertical'>\n\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth'>\n\t\t\t\t\t\t<select name='meta_tag_name[]' class='ipsField_fullWidth' data-role='metaTagChooser'>\n\t\t\t\t\t\t\t<option value='keywords'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_keywords', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t<option value='description'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_description', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t<option value='robots'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_robots', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t\t<option value='other'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'meta_other', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\t<\/select>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth ipsHide' data-role='metaTagName'>\n\t\t\t\t\t\t<input name='meta_tag_name_other[]' type='text' value=\"\" placeholder='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'metatags_name', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t<li class='ipsFieldRow ipsFieldRow_fullWidth'>\n\t\t\t\t\t\t<input name='meta_tag_content[]' type='text' value=\"\" placeholder='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'metatags_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<\/li>\n\t\t\t\t<\/ul>\n\t\t\t<\/li>\n\t\t<\/ul>\n\t\t<br>\n\t\t<a href='#' class='ipsJS_show ipsButton ipsButton_normal ipsButton_fullWidth ipsButton_verySmall' data-action='addMeta'><i class='fa fa-plus'><\/i> &nbsp;\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'add_another_meta_tag', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\n\t\t<div class=\"ipsClearfix ipsPad ipsType_center\" id='elMetaTagEditor_submit'>\n\t\t\t<button class='ipsButton ipsButton_important' role='button' type='submit'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'save', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/button>\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=metatags&do=end\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" class='ipsButton ipsButton_primary'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'end_metatags', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/div>\n\t<\/form>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mobileNavBar(   ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<ul id='elMobileNav' class='ipsList_inline ipsResponsive_hideDesktop ipsResponsive_block' data-controller='core.front.core.mobileNav'>\n\t\nCONTENT;\n\nif ( \\count( \\IPS\\Output::i()->breadcrumb ) ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\count( \\IPS\\Output::i()->breadcrumb ) == 1 ):\n$return .= <<<CONTENT\n\n\t\t\t<li id='elMobileBreadcrumb'>\n\t\t\t\t<a href='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<span>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'home', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$i = 0;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->breadcrumb as $k => $b ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $i + 2 == \\count( \\IPS\\Output::i()->breadcrumb ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li id='elMobileBreadcrumb'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $b[0], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t<span>\nCONTENT;\n$return .= htmlspecialchars( $b[1], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$i++;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\n\t\nCONTENT;\n\n$defaultStream = \\IPS\\core\\Stream::defaultStream();\n$return .= <<<CONTENT\n\n\t<li \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'discover' ) )  ):\n$return .= <<<CONTENT\nclass='ipsHide'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t<a data-action=\"defaultStream\" class='ipsType_light'  href='\nCONTENT;\n\nif ( $defaultStream ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $defaultStream->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=discover&controller=streams\", null, \"discover_all\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='icon-newspaper'><\/i><\/a>\n\t<\/li>\n\n\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->restrict_post and \\count( \\IPS\\Member::loggedIn()->createMenu() ) ):\n$return .= <<<CONTENT\n\n\t<li data-ipsDrawer data-ipsDrawer-drawerElem='#elMobileCreateMenuDrawer'>\n\t\t<a href='#'><i class='fa fa-plus'><\/i><\/a>\n\t<\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'search' ) ) ):\n$return .= <<<CONTENT\n\n\t\t<li class='ipsJS_show'>\n\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search\", null, \"search\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'><i class='fa fa-search'><\/i><\/a>\n\t\t<\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<li data-ipsDrawer data-ipsDrawer-drawerElem='#elMobileDrawer'>\n\t\t<a href='#'>\n\t\t\t\nCONTENT;\n\n$total = \\IPS\\Member::loggedIn()->notification_cnt;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->members_disable_pm and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'messaging' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$total += \\IPS\\Member::loggedIn()->msg_count_new;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) and \\IPS\\Member::loggedIn()->modPermission('can_view_reports') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$total += \\IPS\\Member::loggedIn()->reportCount();\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $total ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='ipsNotificationCount' data-notificationType='total'>\nCONTENT;\n$return .= htmlspecialchars( $total, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<i class='fa fa-navicon'><\/i>\n\t\t<\/a>\n\t<\/li>\n<\/ul>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mobileNavigation(   ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elMobileDrawer' class='ipsDrawer ipsHide'>\n\t<a href='#' class='ipsDrawer_close' data-action='close'><span>&times;<\/span><\/a>\n\t<div class='ipsDrawer_menu'>\n\t\t<div class='ipsDrawer_content'>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t<ul id='elUserNav_mobile' class='ipsList_inline signed_in ipsClearfix'>\n\t\t\t\t\t<li class='cNotifications cUserNav_icon'>\n\t\t\t\t\t\t<a href='#elMobNotifications_menu' id='elMobNotifications' data-ipsMenu data-ipsMenu-menuID='elFullNotifications_menu' data-ipsMenu-closeOnClick='false'>\n\t\t\t\t\t\t\t<i class='fa fa-bell'><\/i> <span class='ipsNotificationCount \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->notification_cnt ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-notificationType='notify'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->notification_cnt, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->members_disable_pm and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'messaging' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class='cInbox cUserNav_icon'>\n\t\t\t\t\t\t\t<a href='#elMobInbox_menu' id='elMobInbox' data-ipsMenu data-ipsMenu-menuID='elFullInbox_menu' data-ipsMenu-closeOnClick='false'>\n\t\t\t\t\t\t\t\t<i class='fa fa-envelope'><\/i> <span class='ipsNotificationCount \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->msg_count_new ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-notificationType='inbox'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->msg_count_new, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) and \\IPS\\Member::loggedIn()->modPermission('can_view_reports') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class='cReports cUserNav_icon'>\n\t\t\t\t\t\t\t<a href='#elMobReports_menu' id='elMobReports' data-ipsMenu data-ipsMenu-menuID='elFullReports_menu' data-ipsMenu-closeOnClick='false'>\n\t\t\t\t\t\t\t\t<i class='fa fa-warning'><\/i> \nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->reportCount() ):\n$return .= <<<CONTENT\n<span class='ipsNotificationCount' data-notificationType='reports'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->reportCount(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t<div class='ipsSpacer_bottom ipsPad'>\n\t\t\t\t<ul class='ipsToolList ipsToolList_vertical'>\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login&do=logout\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_light ipsButton_small ipsButton_fullWidth'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $_SESSION['logged_in_as_key'] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$sprintf = array($_SESSION['logged_in_from']['name']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'switch_to_account', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_out', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' id='elSigninButton_mobile' class='ipsButton ipsButton_light ipsButton_small ipsButton_fullWidth'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Login::registrationType() != 'disabled' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Login::registrationType() == 'redirect' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Settings::i()->allow_reg_target, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target=\"_blank\" rel=\"noopener\" class='ipsButton ipsButton_small ipsButton_fullWidth ipsButton_important'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=register\", null, \"register\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Login::registrationType() == 'normal' ):\n$return .= <<<CONTENT\ndata-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog-fixed='true'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n id='elRegisterButton_mobile' class='ipsButton ipsButton_small ipsButton_fullWidth ipsButton_important'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a class='ipsButton ipsButton_small ipsButton_primary ipsButton_fullWidth' data-action=\"markSiteRead\" data-controller=\"core.front.core.markRead\" href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=markread\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"mark_site_as_read\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mark_site_read_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\n\t\t\t<ul class='ipsDrawer_list'>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsDrawer_itemParent'>\n\t\t\t\t\t\t<h4 class='ipsDrawer_title'><a href='#'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mobile_menu_account', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/h4>\n\t\t\t\t\t\t<ul class='ipsDrawer_list'>\n\t\t\t\t\t\t\t<li data-action=\"back\"><a href='#'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mobile_menu_back', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members', 'front' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_my_profile', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_profile', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['g_attach_max'] != 0 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=attachments\", null, \"attachments\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'my_attachments', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                            \nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'promotion', 'promote_manage' ) and \\IPS\\core\\Promote::promoteServices() ):\n$return .= <<<CONTENT\n\n                            <li><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=promote&controller=promote&do=view\", null, \"promote_manage\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'promote_manage_link', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n                            \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                            \nCONTENT;\n\nif ( \\IPS\\Application::appIsEnabled('nexus') and \\IPS\\Settings::i()->nexus_subs_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=nexus&module=subscriptions&controller=subscriptions\", null, \"nexus_subscriptions\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'nexus_manage_subscriptions', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=followed\", null, \"followed_content\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_followed_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t<li id='elAccountSettingsLinkMobile'><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings\", null, \"settings\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_account_settings', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_settings', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->ignore_system_on ):\n$return .= <<<CONTENT\n\n\t\t\t                \t<li><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ignore\", null, \"ignore\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_manage_ignore', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t                \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) AND \\IPS\\Member::loggedIn()->modPermission() ) or ( \\IPS\\Member::loggedIn()->isAdmin() AND \\IPS\\SHOW_ACP_LINK ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) AND \\IPS\\Member::loggedIn()->modPermission() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=modcp\", null, \"modcp\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_modcp', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->isAdmin() AND \\IPS\\SHOW_ACP_LINK  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::baseURL() . \\IPS\\CP_DIRECTORY, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target='_blank' rel=\"noopener\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_admincp', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-lock'><\/i><\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\nCONTENT;\n\n$primaryBars = \\IPS\\core\\FrontNavigation::i()->roots();\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$subBars = \\IPS\\core\\FrontNavigation::i()->subBars();\n$return .= <<<CONTENT\n\n\t\t\t\t\n\t\t\t\t\nCONTENT;\n\nforeach ( $primaryBars as $id => $item ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $item->canView() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$children = $item->children();\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( ( $subBars && isset( $subBars[ $id ] ) && \\count( $subBars[ $id ] ) ) || $children ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class='ipsDrawer_itemParent'>\n\t\t\t\t\t\t\t\t<h4 class='ipsDrawer_title'><a href='#'>\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/h4>\n\t\t\t\t\t\t\t\t<ul class='ipsDrawer_list'>\n\t\t\t\t\t\t\t\t\t<li data-action=\"back\"><a href='#'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mobile_menu_back', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->link() && $item->link() !== '#' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $children ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->mobileNavigationChildren( $children );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $subBars && isset( $subBars[ $id ] ) && \\count( $subBars[ $id ] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->mobileNavigationChildren( $subBars[ $id ] );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\t\n\t\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( method_exists( $item, 'target' ) AND $item->target() ):\n$return .= <<<CONTENT\ntarget='\nCONTENT;\n$return .= htmlspecialchars( $item->target(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nif ( $item->target() == '_blank' ):\n$return .= <<<CONTENT\n rel=\"noopener\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t<\/div>\n<\/div>\n\n<div id='elMobileCreateMenuDrawer' class='ipsDrawer ipsHide'>\n\t<a href='#' class='ipsDrawer_close' data-action='close'><span>&times;<\/span><\/a>\n\t<div class='ipsDrawer_menu'>\n\t\t<div class='ipsDrawer_content ipsSpacer_bottom ipsPad'>\n\t\t\t<ul class='ipsDrawer_list'>\n\t\t\t\t<li class=\"ipsDrawer_listTitle ipsType_reset\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'add', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n...<\/li>\n\t\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Member::loggedIn()->createMenu() as $k => $url ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $url['link'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $url['extraData'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $url['extraData'] as $data => $v ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $data, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( isset($url['title']) AND $url['title'] ):\n$return .= <<<CONTENT\n data-ipsDialog-title='\nCONTENT;\n\n$val = \"{$url['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( isset($url['flashMessage']) ):\n$return .= <<<CONTENT\n data-ipsdialog-flashmessage=\"\nCONTENT;\n\n$val = \"{$url['flashMessage']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-ipsdialog-fixed=\"true\"\n\t\t\t\t\t\t\t>\nCONTENT;\n\n$val = \"{$k}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mobileNavigationChildren( $items ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nforeach ( $items as $child ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $child->canView() ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $children = $child->children() ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$id = md5( mt_rand() );\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsDrawer_itemParent'>\n\t\t\t\t<h4 class='ipsDrawer_title'><a href='#'>\nCONTENT;\n$return .= htmlspecialchars( $child->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/h4>\n\t\t\t\t<ul class='ipsDrawer_list'>\n\t\t\t\t\t<li data-action=\"back\"><a href='#'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mobile_menu_back', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nif ( $child->link() && $child->link() !== '#' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $child->link(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $child->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->mobileNavigationChildren( $children );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelseif ( $child instanceof \\IPS\\core\\extensions\\core\\FrontNavigation\\MenuHeader ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsDrawer_section'>\n\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $child->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelseif ( $child instanceof \\IPS\\core\\extensions\\core\\FrontNavigation\\MenuSeparator ):\n$return .= <<<CONTENT\n\n\t\t\t\n\t\t\nCONTENT;\n\nelseif ( $child instanceof \\IPS\\core\\extensions\\core\\FrontNavigation\\MenuButton ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsPad_half'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $child->link(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_important ipsButton_verySmall ipsButton_fullWidth'>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $child->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $child->link(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( method_exists( $child, 'target' ) AND $child->target() ):\n$return .= <<<CONTENT\ntarget='\nCONTENT;\n$return .= htmlspecialchars( $child->target(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nif ( $child->target() == '_blank' ):\n$return .= <<<CONTENT\n rel=\"noopener\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $child->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction modBadges( $member ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction navBar( $preview=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !\\in_array('ipsLayout_minimal', \\IPS\\Output::i()->bodyClasses ) ):\n$return .= <<<CONTENT\n\n\t<nav data-controller='core.front.core.navBar' class='\nCONTENT;\n\nif ( !\\count( \\IPS\\core\\FrontNavigation::i()->subBars( $preview ) ) ):\n$return .= <<<CONTENT\nipsNavBar_noSubBars\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t<div class='ipsNavBar_primary ipsLayout_container \nCONTENT;\n\nif ( !\\count( \\IPS\\core\\FrontNavigation::i()->subBars( $preview ) ) ):\n$return .= <<<CONTENT\nipsNavBar_noSubBars\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsClearfix'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->quickSearch( $preview );\n$return .= <<<CONTENT\n\n\t\t\t<ul data-role=\"primaryNavBar\" class='\nCONTENT;\n\nif ( !$preview ):\n$return .= <<<CONTENT\nipsResponsive_showDesktop ipsResponsive_block\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->navBarItems( \\IPS\\core\\FrontNavigation::i()->roots( $preview ), \\IPS\\core\\FrontNavigation::i()->subBars( $preview ), 0, $preview );\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsHide' id='elNavigationMore' data-role='navMore'>\n\t\t\t\t\t<a href='#' data-ipsMenu data-ipsMenu-appendTo='#elNavigationMore' id='elNavigationMore_dropdown'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'more', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<ul class='ipsNavBar_secondary ipsHide' data-role='secondaryNavBar'>\n\t\t\t\t\t\t<li class='ipsHide' id='elNavigationMore_more' data-role='navMore'>\n\t\t\t\t\t\t\t<a href='#' data-ipsMenu data-ipsMenu-appendTo='#elNavigationMore_more' id='elNavigationMore_more_dropdown'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'more', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t\t<ul class='ipsHide ipsMenu ipsMenu_auto' id='elNavigationMore_more_dropdown_menu' data-role='moreDropdown'><\/ul>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/li>\n\t\t\t<\/ul>\n\t\t<\/div>\n\t<\/nav>\n\nCONTENT;\n\nelseif ( \\IPS\\Member::loggedIn()->group['g_view_board'] ):\n$return .= <<<CONTENT\n\n\t<nav>\n\t\t<div class='ipsLayout_container'>\n\t\t\t<div class='ipsNavBar_primary ipsNavBar_noSubBars ipsClearfix'>\n\t\t\t\t<a id='elBackHome' href='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_community_home', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-angle-left'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'community_home', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/nav>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction navBarChildren( $items, $preview=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $items as $item ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $preview or $item->canView() ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $children = $item->children() ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$id = md5( mt_rand() );\n$return .= <<<CONTENT\n\n\t\t\t<li id='elNavigation_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsMenu_item ipsMenu_subItems'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t\t<ul id='elNavigation_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_auto ipsHide'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->navBarChildren( $children, $preview );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelseif ( $item instanceof \\IPS\\core\\extensions\\core\\FrontNavigation\\MenuHeader ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsMenu_title'>\n\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelseif ( $item instanceof \\IPS\\core\\extensions\\core\\FrontNavigation\\MenuSeparator ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsMenu_sep'>\n\t\t\t\t<hr>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelseif ( $item instanceof \\IPS\\core\\extensions\\core\\FrontNavigation\\MenuButton ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsPad_half'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_verySmall ipsButton_fullWidth'>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsMenu_item' {$item->attributes()}>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( method_exists( $item, 'target' ) AND $item->target() ):\n$return .= <<<CONTENT\ntarget='\nCONTENT;\n$return .= htmlspecialchars( $item->target(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nif ( $item->target() == '_blank' ):\n$return .= <<<CONTENT\n rel=\"noopener\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction navBarItems( $roots, $subBars=NULL, $parent=0, $preview=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$first = TRUE;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $roots as $id => $item ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $preview or $item->canView() ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$active = $preview ? $first : $item->activeOrChildActive();\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $active ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n\\IPS\\core\\FrontNavigation::i()->activePrimaryNavBar = $item->id;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<li \nCONTENT;\n\nif ( $active ):\n$return .= <<<CONTENT\nclass='ipsNavBar_active' data-active\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n id='elNavSecondary_\nCONTENT;\n$return .= htmlspecialchars( $item->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role=\"navBarItem\" data-navApp=\"\nCONTENT;\n\n$return .= htmlspecialchars( mb_substr( \\get_class( $item ), 4, mb_strpos( \\get_class( $item ), '\\\\', 4 ) - 4 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-navExt=\"\nCONTENT;\n\n$return .= htmlspecialchars( mb_substr( \\get_class( $item ), mb_strrpos( \\get_class( $item ), '\\\\' ) + 1 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\nCONTENT;\n\n$children = $item->children();\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $children ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\nif ( $item->link() ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n#\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" id=\"elNavigation_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsMenu data-ipsMenu-appendTo='#\nCONTENT;\n\nif ( $parent ):\n$return .= <<<CONTENT\nelNavSecondary_\nCONTENT;\n$return .= htmlspecialchars( $parent, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nelNavSecondary_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsMenu-activeClass='ipsNavActive_menu' data-navItem-id=\"\nCONTENT;\n$return .= htmlspecialchars( $item->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( $active ):\n$return .= <<<CONTENT\ndata-navDefault\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n <i class=\"fa fa-caret-down\"><\/i>\n\t\t\t\t<\/a>\n\t\t\t\t<ul id=\"elNavigation_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu\" class=\"ipsMenu ipsMenu_auto ipsHide\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->navBarChildren( $children, $preview );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\nif ( $item->link() ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $item->link(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n#\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( method_exists( $item, 'target' ) AND $item->target() ):\n$return .= <<<CONTENT\ntarget='\nCONTENT;\n$return .= htmlspecialchars( $item->target(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nif ( $item->target() == '_blank' ):\n$return .= <<<CONTENT\n rel=\"noopener\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-navItem-id=\"\nCONTENT;\n$return .= htmlspecialchars( $item->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( $active ):\n$return .= <<<CONTENT\ndata-navDefault\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $subBars && isset( $subBars[ $id ] ) && \\count( $subBars[ $id ] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<ul class='ipsNavBar_secondary \nCONTENT;\n\nif ( !$active ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-role='secondaryNavBar'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->navBarItems( $subBars[ $id ], NULL, $item->id, $preview );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsHide' id='elNavigationMore_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role='navMore'>\n\t\t\t\t\t\t<a href='#' data-ipsMenu data-ipsMenu-appendTo='#elNavigationMore_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='elNavigationMore_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_dropdown'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'more', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t<ul class='ipsHide ipsMenu ipsMenu_auto' id='elNavigationMore_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_dropdown_menu' data-role='moreDropdown'><\/ul>\n\t\t\t\t\t<\/li>\n\t\t\t\t<\/ul>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$first = FALSE;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction pageHeader( $title, $blurb='', $rawBlurb=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div class='ipsPageHeader ipsClearfix ipsSpacer_bottom'>\n\t<h1 class='ipsType_pageTitle'>\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h1>\n\t\nCONTENT;\n\nif ( $blurb ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsPageHeader_info ipsType_light'>\n\t\t\t\nCONTENT;\n\nif ( !$rawBlurb ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $blurb, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t{$blurb}\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction pixel( $events, $addScriptTags=true ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->fb_pixel_id and \\IPS\\Settings::i()->fb_pixel_enabled ):\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $addScriptTags ):\n$return .= <<<CONTENT\n<script>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nsetTimeout( function() {\n\t\nCONTENT;\n\nforeach ( $events as $name => $params ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$inlineParams = '';\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\count( $params ) ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$inlineParams = json_encode( $params );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $inlineParams ):\n$return .= <<<CONTENT\n\n\t\tfbq('track', '\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n', {$inlineParams});\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\tfbq('track', '\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n');\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n}, \nCONTENT;\n\n$return .= htmlspecialchars( \\intval( \\IPS\\Settings::i()->fb_pixel_delay * 1000 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n );\n\nCONTENT;\n\nif ( $addScriptTags ):\n$return .= <<<CONTENT\n<\/script>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction prefix( $encoded, $text ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $text ):\n$return .= <<<CONTENT\n\n\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search&tags={$encoded}\", null, \"tags\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$sprintf = array($text); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'find_tagged_content', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\" class='ipsTag_prefix' rel=\"tag\"><span>\nCONTENT;\n$return .= htmlspecialchars( $text, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span><\/a>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction profileNextStep( $nextStep, $canDismiss=false, $hideOnCompletion=true ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$completion = \\intval( (string) \\IPS\\Member::loggedIn()->profileCompletionPercentage() );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( ! ( $completion == 100 and $hideOnCompletion ) ):\n$return .= <<<CONTENT\n\n<div class='ipsBox ipsPad ipsSpacer_bottom' data-role='profileWidget' data-controller=\"core.front.core.profileCompletion\">\n\t<div>\n\t\t\nCONTENT;\n\nif ( $completion < 100 ):\n$return .= <<<CONTENT\n\n\t\t<ul class=\"ipsButton_split ipsPos_right ipsSpacer_bottom\">\n\t\t\t<li>\n\t\t\t\t<a class=\"ipsButton ipsButton_important ipsButton_veryVerySmall\" href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=completion&_new=1\", null, \"settings\", array(), 0 )->addRef((string) \\IPS\\Request::i()->url()), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'complete_my_profile', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nif ( $canDismiss ):\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a class=\"ipsButton ipsButton_link ipsButton_linkNeutral ipsButton_veryVerySmall\" href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=dismissProfile\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 )->addRef((string) \\IPS\\Request::i()->url()), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-role='dismissProfile'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'dismiss', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\t<h4 class=\"ipsType_reset ipsType_normal\"><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'profile_step_next', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\n$val = \"profile_step_title_{$nextStep->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/h4>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<div class=\"ipsProgressBar ipsProgressBar_fullWidth\">\n\t\t<div class='ipsProgressBar_progress' style='width: \nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->profileCompletionPercentage(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n%'>\n\t\t\t\nCONTENT;\n\n$sprintf = array($completion . '%'); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'profile_completion_percent', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction promote( $object ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $object->canPromoteToSocialMedia() and ( $object instanceof \\IPS\\Content or $object instanceof \\IPS\\Node\\Model ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$column = $object::$databaseColumnId;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->promoteLink( $object, \\IPS\\core\\Promote::loadByClassAndId( \\get_class( $object ), $object->$column, TRUE ), TRUE );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction promoteLink( $object, $promote=NULL, $withIcons=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$class = \\get_class($object);\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$column = $class::$databaseColumnId;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$id = $object->$column;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $promote and $promote->id ):\n$return .= <<<CONTENT\n\n\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=promote&controller=promote&class={$class}&id={$id}&promote_id={$promote->id}&repromote=1\", null, \"promote\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-ipsDialog-flashMessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'promote_flash_msg', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsDialog-fixed data-ipsDialog-size='large' data-ipsDialog-flashMessageTimeout=\"5\" data-ipsDialog-flashMessageEscape=\"false\" data-ipsDialog data-ipsDialog-remoteSubmit=\"true\" data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'promote_social_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_blendLinks ipsType_noUnderline\">\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=promote&controller=promote&class={$class}&id={$id}\", null, \"promote\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-ipsDialog-flashMessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'promote_flash_msg', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsDialog-flashMessageTimeout=\"5\" data-ipsDialog-flashMessageEscape=\"false\" data-ipsDialog-fixed data-ipsDialog-size='large' data-ipsDialog data-ipsDialog-remoteSubmit=\"true\" data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'promote_social_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_blendLinks ipsType_noUnderline\">\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $withIcons ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsPromote ipsButton \nCONTENT;\n\nif ( $promote and $promote->id ):\n$return .= <<<CONTENT\nipsButton_light\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsButton_veryLight\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsButton_verySmall ipsButton_link\">\n\t\t\nCONTENT;\n\nforeach ( \\IPS\\core\\Promote::promoteServices() as $service ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsPromote_icon ipsSocial_\nCONTENT;\n$return .= htmlspecialchars( $service->_key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t<i class=\"fa fa-\nCONTENT;\n$return .= htmlspecialchars( $service::$icon, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"><\/i>\n\t\t<\/div>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<span class=\"ipsPromoteText\">\n\t\t\t\nCONTENT;\n\nif ( $promote and $promote->id ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'promote_social_button_repromote', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'promote_social_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/span>\n\t<\/div>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<span class=\"ipsPromoteText\">\n\t\t\nCONTENT;\n\nif ( $promote and $promote->id ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'promote_social_button_repromote', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'promote_social_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/span>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/a>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction queryLog( $log ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"elQueryLog\">\n\t<h3 class='ipsType_center'>\nCONTENT;\n\n$return .= htmlspecialchars( \\count( $log ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h3>\n\t\nCONTENT;\n\nforeach ( $log as $i => $query ):\n$return .= <<<CONTENT\n\n\t\t<div>\n\t\t\t<pre class=\"prettyprint lang-sql\" data-ipsDialog data-ipsDialog-content=\"#elQueryLog\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu\">\nCONTENT;\n\nif ( $query['server'] ):\n$return .= <<<CONTENT\n(\nCONTENT;\n$return .= htmlspecialchars( $query['server'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n): \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $query['query'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/pre>\n\t\t\t\nCONTENT;\n\nif ( $query['extra'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsType_center\">\n\t\t\t\t\t<strong class=\"ipsType_warning\"><i class=\"fa fa-exclamation-circle\"><\/i> \nCONTENT;\n$return .= htmlspecialchars( $query['extra'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t<\/div>\n\t\t\t\t<br>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div id='elQueryLog\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsPad ipsHide'>\n\t\t\t\t<br>\n\t\t\t\t<pre>\nCONTENT;\n$return .= htmlspecialchars( $query['query'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/pre>\n\t\t\t\t<hr class=\"ipsHr\">\n\t\t\t\t<pre class=\"prettyprint lang-php\">\nCONTENT;\n$return .= htmlspecialchars( $query['backtrace'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/pre>\n\t\t\t\t<br>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<hr class=\"ipsHr\">\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction quickSearch( $preview=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !$preview and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'search' ) ) AND !\\in_array('ipsLayout_minimal', \\IPS\\Output::i()->bodyClasses ) ):\n$return .= <<<CONTENT\n\n\t<div id=\"elSearchWrapper\" class=\"ipsPos_right\">\n\t\t<div id='elSearch' class='' data-controller='core.front.core.quickSearch'>\n\t\t\t<form accept-charset='utf-8' action='\nCONTENT;\n\n$return .= str_replace( array( 'http:\/\/', 'https:\/\/' ), '\/\/', htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search&do=quicksearch\", null, \"search\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE ) );\n$return .= <<<CONTENT\n' method='post'>\n\t\t\t\t<input type='search' id='elSearchField' placeholder='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'search_placeholder', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' name='q' autocomplete='off'>\n\t\t\t\t<button class='cSearchSubmit' type=\"submit\"><i class=\"fa fa-search\"><\/i><\/button>\n\t\t\t\t<div id=\"elSearchExpanded\">\n\t\t\t\t\t<div class=\"ipsMenu_title\">\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'class', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<ul class=\"ipsSideMenu_list ipsSideMenu_withRadios ipsSideMenu_small ipsType_normal\" data-ipsSideMenu data-ipsSideMenu-type=\"radio\" data-ipsSideMenu-responsive=\"false\" data-role=\"searchContexts\">\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<span class='ipsSideMenu_item ipsSideMenu_itemActive' data-ipsMenuValue='all'>\n\t\t\t\t\t\t\t\t<input type=\"radio\" name=\"type\" value=\"all\" checked id=\"elQuickSearchRadio_type_all\">\n\t\t\t\t\t\t\t\t<label for='elQuickSearchRadio_type_all' id='elQuickSearchRadio_type_all_label'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'everywhere', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/label>\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\n$option = \\IPS\\Output::i()->defaultSearchOption;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Output::i()->defaultSearchOption[0] != 'all' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<span class='ipsSideMenu_item' data-ipsMenuValue='\nCONTENT;\n$return .= htmlspecialchars( $option[0], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" name=\"type\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $option[0], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" id=\"elQuickSearchRadio_type_\nCONTENT;\n$return .= htmlspecialchars( $option[0], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\t\t\t<label for='elQuickSearchRadio_type_\nCONTENT;\n$return .= htmlspecialchars( $option[0], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='elQuickSearchRadio_type_\nCONTENT;\n$return .= htmlspecialchars( $option[0], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_label'>\nCONTENT;\n\n$val = \"{$option[1]}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/label>\n\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\count( \\IPS\\Output::i()->contextualSearchOptions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( array_reverse( \\IPS\\Output::i()->contextualSearchOptions ) as $name => $data ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<span class='ipsSideMenu_item' data-ipsMenuValue='contextual_\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( $data ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" name=\"type\" value='contextual_\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( $data ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='elQuickSearchRadio_type_contextual_\nCONTENT;\n\n$return .= htmlspecialchars( md5( json_encode( $data ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t\t\t\t<label for='elQuickSearchRadio_type_contextual_\nCONTENT;\n\n$return .= htmlspecialchars( md5( json_encode( $data ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='elQuickSearchRadio_type_contextual_\nCONTENT;\n\n$return .= htmlspecialchars( md5( json_encode( $data ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_label'>\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/label>\n\t\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li data-role=\"showMoreSearchContexts\">\n\t\t\t\t\t\t\t<span class='ipsSideMenu_item' data-action=\"showMoreSearchContexts\" data-exclude=\"\nCONTENT;\n$return .= htmlspecialchars( $option[0], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'more_options', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t<\/ul>\n\t\t\t\t\t<div class=\"ipsMenu_title\">\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'andOr', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<ul class='ipsSideMenu_list ipsSideMenu_withRadios ipsSideMenu_small ipsType_normal' role=\"radiogroup\" data-ipsSideMenu data-ipsSideMenu-type=\"radio\" data-ipsSideMenu-responsive=\"false\" data-filterType='andOr'>\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Settings::i()->search_default_operator == 'and' ? array( 'and', 'or' ) : array( 'or', 'and' ) as $k ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<span class='ipsSideMenu_item \nCONTENT;\n\nif ( \\IPS\\Settings::i()->search_default_operator == $k ):\n$return .= <<<CONTENT\nipsSideMenu_itemActive\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsMenuValue='\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" name=\"search_and_or\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( \\IPS\\Settings::i()->search_default_operator == $k ):\n$return .= <<<CONTENT\nchecked\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n id=\"elRadio_andOr_\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\t\t\t<label for='elRadio_andOr_\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='elField_andOr_label_\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$val = \"search_{$k}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/label>\n\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t\t<div class=\"ipsMenu_title\">\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'searchIn', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<ul class='ipsSideMenu_list ipsSideMenu_withRadios ipsSideMenu_small ipsType_normal' role=\"radiogroup\" data-ipsSideMenu data-ipsSideMenu-type=\"radio\" data-ipsSideMenu-responsive=\"false\" data-filterType='searchIn'>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<span class='ipsSideMenu_item ipsSideMenu_itemActive' data-ipsMenuValue='all'>\n\t\t\t\t\t\t\t\t<input type=\"radio\" name=\"search_in\" value=\"all\" checked id=\"elRadio_searchIn_and\">\n\t\t\t\t\t\t\t\t<label for='elRadio_searchIn_and' id='elField_searchIn_label_all'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'titles_and_body', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/label>\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<span class='ipsSideMenu_item' data-ipsMenuValue='titles'>\n\t\t\t\t\t\t\t\t<input type=\"radio\" name=\"search_in\" value=\"titles\" id=\"elRadio_searchIn_titles\">\n\t\t\t\t\t\t\t\t<label for='elRadio_searchIn_titles' id='elField_searchIn_label_titles'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'titles_only', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/label>\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/div>\n\t\t\t<\/form>\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction rating( $size, $value, $max=5, $memberRating=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div \nCONTENT;\n\nif ( $memberRating ):\n$return .= <<<CONTENT\ndata-ipsTooltip title='\nCONTENT;\n\n$sprintf = array($memberRating, $max, $value); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'you_rated_x_stars', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n class='ipsClearfix ipsRating \nCONTENT;\n\nif ( $memberRating ):\n$return .= <<<CONTENT\nipsRating_rated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $size ):\n$return .= <<<CONTENT\nipsRating_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nif ( $memberRating ):\n$return .= <<<CONTENT\n\n\t\t<ul class='ipsRating_mine'>\n\t\t\t\nCONTENT;\n\nforeach ( range( 1, $max ) as $i ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $i <= $memberRating ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsRating_on'>\n\t\t\t\t\t\t<i class='fa fa-star'><\/i>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsRating_off'>\n\t\t\t\t\t\t<i class='fa fa-star'><\/i>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<ul class='ipsRating_collective'>\n\t\t\nCONTENT;\n\nforeach ( range( 1, $max ) as $i ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $i <= $value ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsRating_on'>\n\t\t\t\t\t<i class='fa fa-star'><\/i>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nelseif ( ( $i - 0.5 ) <= $value ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsRating_half'>\n\t\t\t\t\t<i class='fa fa-star-half'><\/i><i class='fa fa-star-half fa-flip-horizontal'><\/i>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsRating_off'>\n\t\t\t\t\t<i class='fa fa-star'><\/i>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reactionBlurb( $content ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !\\IPS\\Content\\Reaction::isLikeMode() ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$reactions = \\IPS\\Content\\Reaction::roots();\n$return .= <<<CONTENT\n\n\t<ul class='ipsReact_reactions'>\n\t\nCONTENT;\n\nforeach ( $content->reactBlurb() AS $key => $count ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( isset( $reactions[ $key ] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$reaction = $reactions[ $key ];\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsReact_reactCount'>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url('showReactions')->setQueryString( 'reaction', $reaction->id ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='medium' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip title=\"\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->addToStack( 'reaction_title_' . $reaction->id )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted_x', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf, 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span data-ipsTooltip title=\"\nCONTENT;\n\n$val = \"reaction_title_{$reaction->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t<img src='\nCONTENT;\n\n$return .= \\IPS\\File::get( \"core_Reaction\", $reaction->_icon )->url;\n$return .= <<<CONTENT\n' alt=\"\nCONTENT;\n\n$val = \"reaction_title_{$reaction->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $count, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t<span class='ipsType_blendLinks'>\n\t\t\nCONTENT;\n$return .= htmlspecialchars( $content->whoReacted(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t<\/span>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<div class='ipsReact_overview ipsType_blendLinks'>\n\t\nCONTENT;\n\nif ( !\\IPS\\Content\\Reaction::isLikeMode() && \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n$return .= htmlspecialchars( $content->whoReacted(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Content\\Reaction::isLikeMode() and \\IPS\\Member::loggedIn()->modPermission('can_remove_reactions') ):\n$return .= <<<CONTENT\n\n\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url('showReactions'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='medium' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>&nbsp;<i class=\"fa fa-pencil\"><\/i><\/a>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reactionLog( $table, $headers, $rows ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $rows as $row ):\n$return .= <<<CONTENT\n\n\t<li class='ipsGrid_span6 ipsPhotoPanel ipsPhotoPanel_mini ipsClearfix'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::load( $row['member_id'] ), 'mini' );\n$return .= <<<CONTENT\n\n\t\t<div>\n\t\t\t<h3 class='ipsType_normal ipsType_reset ipsTruncate ipsTruncate_line'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLink( \\IPS\\Member::load( $row['member_id'] ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t<span class='ipsType_light'>\n\t\t\t\t\nCONTENT;\n\nif ( !isset( \\IPS\\Request::i()->reaction ) || \\IPS\\Request::i()->reaction == 'all' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$reaction = \\IPS\\Content\\Reaction::load( $row['reaction'] );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<img src='\nCONTENT;\n\n$return .= \\IPS\\File::get( \"core_Reaction\", $reaction->_icon )->url;\n$return .= <<<CONTENT\n' height='20' width='20'>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n <span class='ipsType_medium'>\nCONTENT;\n\n$val = ( $row['rep_date'] instanceof \\IPS\\DateTime ) ? $row['rep_date'] : \\IPS\\DateTime::ts( $row['rep_date'] );$return .= $val->html();\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/span>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->modPermission('can_remove_reactions') and \\count( $row['_buttons'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $row['_buttons']['delete']['link'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( isset( $row['_buttons']['delete']['data'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $row['_buttons']['delete']['data'] as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\tdata-\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n><i class=\"fa fa-\nCONTENT;\n$return .= htmlspecialchars( $row['_buttons']['delete']['icon'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"><\/i><\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/li>\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reactionLogTable( $table, $headers, $rows, $quickSearch ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-baseurl='\nCONTENT;\n$return .= htmlspecialchars( $table->baseUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-resort='\nCONTENT;\n$return .= htmlspecialchars( $table->resortKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-controller='core.global.core.table' \nCONTENT;\n\nif ( $table->getPaginationKey() != 'page' ):\n$return .= <<<CONTENT\ndata-pageParam='\nCONTENT;\n$return .= htmlspecialchars( $table->getPaginationKey(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\n\t\nCONTENT;\n\nif ( $table->pages > 1 ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsButtonBar ipsPad_half ipsClearfix ipsClear\">\n\t\t\t<div data-role=\"tablePagination\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->pagination( $table->baseUrl, $table->pages, $table->page, $table->limit, TRUE, $table->getPaginationKey() );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\n\t\nCONTENT;\n\nif ( \\count( $rows ) ):\n$return .= <<<CONTENT\n\n\t\t<ol class='ipsGrid ipsGrid_collapsePhone ipsPad ipsClear \nCONTENT;\n\nforeach ( $table->classes as $class ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $class, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n' id='elTable_\nCONTENT;\n$return .= htmlspecialchars( $table->uniqueId, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role=\"tableRows\" itemscope itemtype=\"http:\/\/schema.org\/ItemList\">\n\t\t\t\nCONTENT;\n\n$return .= $table->rowsTemplate[0]->{$table->rowsTemplate[1]}( $table, $headers, $rows );\n$return .= <<<CONTENT\n\n\t\t<\/ol>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<div class='ipsType_center ipsPad'>\n\t\t\t<p class='ipsType_large ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_rows_in_table', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nif ( method_exists( $table, 'container' ) AND $table->container() !== NULL ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $table->container()->can('add') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $table->container()->url()->setQueryString( 'do', 'add' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_medium'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'submit_first_row', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\n\t\nCONTENT;\n\nif ( $table->pages > 1 ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsButtonBar ipsPad_half ipsClearfix ipsClear\">\n\t\t\t<div data-role=\"tablePagination\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->pagination( $table->baseUrl, $table->pages, $table->page, $table->limit, TRUE, $table->getPaginationKey() );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reactionOverview( $content, $showCount=TRUE, $size=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div class='ipsReactOverview \nCONTENT;\n\nif ( $size ):\n$return .= <<<CONTENT\nipsReactOverview_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reaction_count_display == 'count' ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsType_center'>\n\t\t\t<span class='ipsReact_reactCountOnly ipsType_center \nCONTENT;\n\nif ( $content->reactionCount() >= 1 ):\n$return .= <<<CONTENT\nipsAreaBackground_positive\nCONTENT;\n\nelseif ( $content->reactionCount() < 0 ):\n$return .= <<<CONTENT\nipsAreaBackground_negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsAreaBackground_light\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsType_blendLinks'>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url('showReactions'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $content->reactionCount(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/span>\n\t\t<\/div>\n\t\t<p class='ipsType_reset ipsType_center'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'repuation_points', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/p>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\count( $content->reactBlurb() ) ):\n$return .= <<<CONTENT\n\n\t\t\t<ul>\n\t\t\t\t\nCONTENT;\n\nforeach ( array_reverse( $content->reactBlurb(), TRUE ) AS $key => $count ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$reaction = \\IPS\\Content\\Reaction::load( $key );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url('showReactions')->setQueryString( 'reaction', $reaction->id ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip title=\"\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->addToStack( 'reaction_title_' . $reaction->id )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted_x', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf, 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span data-ipsTooltip title=\"\nCONTENT;\n\n$val = \"reaction_title_{$reaction->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<img src='\nCONTENT;\n\n$return .= \\IPS\\File::get( \"core_Reaction\", $reaction->_icon )->url;\n$return .= <<<CONTENT\n' alt=\"\nCONTENT;\n\n$val = \"reaction_title_{$reaction->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $showCount && $size == 'small' && \\count( $content->reactions() ) ):\n$return .= <<<CONTENT\n\n\t\t\t<span class='ipsType_medium'>\nCONTENT;\n\n$return .= htmlspecialchars( \\count( $content->reactions() ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\nCONTENT;\n\nelseif ( $showCount ):\n$return .= <<<CONTENT\n\n\t\t\t<p class='ipsType_reset ipsType_center'>\n\t\t\t\t\nCONTENT;\n\n$pluralize = array( \\count( $content->reactions() ) ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'react_total', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reactionTabs( $tabs, $activeId, $defaultContent, $url, $tabParam='tab', $parseNames=TRUE, $contained=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='ipsTabs ipsClearfix cReactionTabs' id='elTabs_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTabBar data-ipsTabBar-contentArea='#ipsTabs_content_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\ndata-ipsTabBar-updateURL='false'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t<a href='#elTabs_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\count( $tabs ) > 1 ):\n$return .= <<<CONTENT\ndata-action='expandTabs'><i class='fa fa-caret-down'><\/i>\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\n\t<ul role='tablist'>\n\t\t\nCONTENT;\n\nforeach ( $tabs as $i => $tab ):\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( $tabParam, $i ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class=\"ipsTabs_item \nCONTENT;\n\nif ( isset( $tab['count'] ) && $tab['count'] == 0 ):\n$return .= <<<CONTENT\nipsTabs_itemDisabled\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $i == $activeId ):\n$return .= <<<CONTENT\nipsTabs_activeItem\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" title='\nCONTENT;\n\nif ( $parseNames ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= strip_tags( \\IPS\\Member::loggedIn()->language()->get( $tab['title'] ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= strip_tags( $tab['title'] );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' role=\"tab\" aria-selected=\"\nCONTENT;\n\nif ( $i == $activeId ):\n$return .= <<<CONTENT\ntrue\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfalse\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\nCONTENT;\n\nif ( isset( $tab['icon'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<img src='\nCONTENT;\n\n$return .= \\IPS\\File::get( \"core_Reaction\", $tab['icon'] )->url;\n$return .= <<<CONTENT\n' width='20' height='20' alt=\"\nCONTENT;\n\n$val = \"reaction_title_{$i}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip title=\"\nCONTENT;\n\n$val = \"reaction_title_{$i}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $parseNames ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$val = \"{$tab['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n{$tab['title']}\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( isset( $tab['count'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class='ipsType_light'>(\nCONTENT;\n$return .= htmlspecialchars( $tab['count'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n)<\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/div>\n\n<section id='ipsTabs_content_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsTabs_panels \nCONTENT;\n\nif ( $contained ):\n$return .= <<<CONTENT\nipsTabs_contained\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nforeach ( $tabs as $i => $tab ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $i == $activeId ):\n$return .= <<<CONTENT\n\n\t\t\t<div id='ipsTabs_elTabs_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_panel' class=\"ipsTabs_panel\" aria-labelledby=\"\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" aria-hidden=\"false\">\n\t\t\t\t{$defaultContent}\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/section>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reputation( $content, $extraClass='', $forceType=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\IPS::classUsesTrait( $content, 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_enabled and $enabledReactions = \\IPS\\Content\\Reaction::enabledReactions() ):\n$return .= <<<CONTENT\n\n\t<div data-controller='core.front.core.reaction' class='ipsItemControls_right ipsClearfix \nCONTENT;\n\nif ( $extraClass ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $extraClass, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\t\n\t\t<div class='ipsReact ipsPos_right'>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reaction_count_display == 'count' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$reactionCount = $content->reactionCount();\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsReact_reactCountOnly \nCONTENT;\n\nif ( $reactionCount >= 1 ):\n$return .= <<<CONTENT\nipsAreaBackground_positive\nCONTENT;\n\nelseif ( $reactionCount < 0 ):\n$return .= <<<CONTENT\nipsAreaBackground_negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsAreaBackground_light\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsType_blendLinks \nCONTENT;\n\nif ( !\\count( $content->reactions() ) ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-role='reactCount'>\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url('showReactions'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span data-role='reactCountText'>\nCONTENT;\n$return .= htmlspecialchars( $reactionCount, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$reactBlurb = $content->reactBlurb();\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsReact_blurb \nCONTENT;\n\nif ( !$reactBlurb ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-role='reactionBlurb'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $reactBlurb ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reactionBlurb( $content );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\n\t\t\t\nCONTENT;\n\nif ( $content->canReact() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$defaultReaction = reset( $enabledReactions );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$reactButton = ( $reacted = $content->reacted() and isset( $enabledReactions[ $reacted->id ] ) ) ? $enabledReactions[ $reacted->id ] : $defaultReaction;\n$return .= <<<CONTENT\n\n\n\t\t\t\t<div class='ipsReact_types' data-role='reactionInteraction' data-unreact=\"\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'unreact' )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\nCONTENT;\n\nif ( !\\IPS\\Content\\Reaction::isLikeMode() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<ul class='ipsList_inline' data-role='reactTypes'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $enabledReactions as $reaction ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $reaction->id == $reactButton->id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\ncontinue;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'react' )->setQueryString( 'reaction', $reaction->id )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsReact_reaction' data-role=\"reaction\" \nCONTENT;\n\nif ( $reaction->id == $defaultReaction->id ):\n$return .= <<<CONTENT\ndata-defaultReaction\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\t\t\t\t<img src='\nCONTENT;\n\n$return .= \\IPS\\File::get( \"core_Reaction\", $reaction->_icon )->url;\n$return .= <<<CONTENT\n' alt=\"\nCONTENT;\n\n$val = \"reaction_title_{$reaction->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip title=\"\nCONTENT;\n\n$val = \"reaction_title_{$reaction->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\t\t\t\t<span class='ipsReact_name'>\nCONTENT;\n\n$val = \"reaction_title_{$reaction->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\t<span class='ipsReact_button \nCONTENT;\n\nif ( $reacted !== FALSE ):\n$return .= <<<CONTENT\nipsReact_reacted\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-action='reactLaunch'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'react' )->setQueryString( 'reaction', $reactButton->id )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsReact_reaction' data-role=\"reaction\" \nCONTENT;\n\nif ( $reactButton->id == $defaultReaction->id ):\n$return .= <<<CONTENT\ndata-defaultReaction\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\t<img src='\nCONTENT;\n\n$return .= \\IPS\\File::get( \"core_Reaction\", $reactButton->_icon )->url;\n$return .= <<<CONTENT\n' alt=\"\nCONTENT;\n\n$val = \"reaction_title_{$reactButton->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip title=\"\nCONTENT;\n\n$val = \"reaction_title_{$reactButton->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\t<span class='ipsReact_name'>\nCONTENT;\n\n$val = \"reaction_title_{$reactButton->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t<\/span>\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'unreact' )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsReact_unreact \nCONTENT;\n\nif ( $reacted == FALSE ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-action='unreact' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reaction_remove', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>&times;<\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reputationBadge( $author ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_enabled and \\IPS\\Settings::i()->reputation_show_profile and $author->member_id ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$author->member_id}&do=reputation\", null, \"profile_reputation\", array( $author->members_seo_name ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reputation_badge_tooltip', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class='ipsRepBadge \nCONTENT;\n\nif ( $author->pp_reputation_points > 0 ):\n$return .= <<<CONTENT\nipsRepBadge_positive\nCONTENT;\n\nelseif ( $author->pp_reputation_points < 0 ):\n$return .= <<<CONTENT\nipsRepBadge_negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsRepBadge_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<span title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reputation_badge_tooltip', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class='ipsRepBadge \nCONTENT;\n\nif ( $author->pp_reputation_points > 0 ):\n$return .= <<<CONTENT\nipsRepBadge_positive\nCONTENT;\n\nelseif ( $author->pp_reputation_points < 0 ):\n$return .= <<<CONTENT\nipsRepBadge_negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsRepBadge_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<i class='fa \nCONTENT;\n\nif ( $author->pp_reputation_points > 0 ):\n$return .= <<<CONTENT\nfa-plus-circle\nCONTENT;\n\nelseif ( $author->pp_reputation_points < 0 ):\n$return .= <<<CONTENT\nfa-minus-circle\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfa-circle\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( abs( $author->pp_reputation_points ) );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t<\/a>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<\/span>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reputationLog( $table, $headers, $rows ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $rows as $row ):\n$return .= <<<CONTENT\n\n\t<li class='ipsGrid_span6 ipsPhotoPanel ipsPhotoPanel_mini ipsClearfix'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::load( $row['member_id'] ), 'mini' );\n$return .= <<<CONTENT\n\n\t\t<div>\n\t\t\t<h3 class='ipsType_normal ipsType_reset ipsTruncate ipsTruncate_line'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLink( \\IPS\\Member::load( $row['member_id'] ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t<span class='ipsType_light'>\n\t\t\t\t\nCONTENT;\n\nif ( $row['rep_rating'] === '1' && \\IPS\\Settings::i()->reputation_point_types != 'like' ):\n$return .= <<<CONTENT\n<i class='ipsType_large ipsType_positive fa fa-arrow-circle-up'><\/i>\nCONTENT;\n\nelseif ( \\IPS\\Settings::i()->reputation_point_types != 'like' ):\n$return .= <<<CONTENT\n<i class='ipsType_large ipsType_negative fa fa-arrow-circle-down'><\/i>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n <span class='ipsType_medium'>\nCONTENT;\n\n$val = ( $row['rep_date'] instanceof \\IPS\\DateTime ) ? $row['rep_date'] : \\IPS\\DateTime::ts( $row['rep_date'] );$return .= $val->html();\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/span>\n\t\t<\/div>\n\t<\/li>\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reputationLogTable( $table, $headers, $rows, $quickSearch ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-baseurl='\nCONTENT;\n$return .= htmlspecialchars( $table->baseUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-resort='\nCONTENT;\n$return .= htmlspecialchars( $table->resortKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-controller='core.global.core.table' \nCONTENT;\n\nif ( $table->getPaginationKey() != 'page' ):\n$return .= <<<CONTENT\ndata-pageParam='\nCONTENT;\n$return .= htmlspecialchars( $table->getPaginationKey(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\n\t\nCONTENT;\n\nif ( $table->pages > 1 ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsButtonBar ipsPad_half ipsClearfix ipsClear\">\n\t\t\t<div data-role=\"tablePagination\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->pagination( $table->baseUrl, $table->pages, $table->page, $table->limit, TRUE, $table->getPaginationKey() );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\n\t\nCONTENT;\n\nif ( \\count( $rows ) ):\n$return .= <<<CONTENT\n\n\t\t<ol class='ipsGrid ipsGrid_collapsePhone ipsPad ipsClear \nCONTENT;\n\nforeach ( $table->classes as $class ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $class, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n' id='elTable_\nCONTENT;\n$return .= htmlspecialchars( $table->uniqueId, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role=\"tableRows\">\n\t\t\t\nCONTENT;\n\n$return .= $table->rowsTemplate[0]->{$table->rowsTemplate[1]}( $table, $headers, $rows );\n$return .= <<<CONTENT\n\n\t\t<\/ol>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<div class='ipsType_center ipsPad'>\n\t\t\t<p class='ipsType_large ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_rows_in_table', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nif ( method_exists( $table, 'container' ) AND $table->container() !== NULL ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $table->container()->can('add') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $table->container()->url()->setQueryString( 'do', 'add' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_medium'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'submit_first_row', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\n\t\nCONTENT;\n\nif ( $table->pages > 1 ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsButtonBar ipsPad_half ipsClearfix ipsClear\">\n\t\t\t<div data-role=\"tablePagination\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->pagination( $table->baseUrl, $table->pages, $table->page, $table->limit, TRUE, $table->getPaginationKey() );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reputationMini( $content, $allowRep=TRUE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$allowRep = TRUE;\n$return .= <<<CONTENT\n\n<div data-controller='core.front.core.reaction' class='ipsReact ipsReact_mini \nCONTENT;\n\nif ( !$allowRep ):\n$return .= <<<CONTENT\nipsReact_miniNoInteraction\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\n\t\nCONTENT;\n\nif ( $content ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reaction_count_display == 'count' ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsReact_reactCountOnly ipsReact_reactCountOnly_mini \nCONTENT;\n\nif ( $content->reactionCount() >= 1 ):\n$return .= <<<CONTENT\nipsAreaBackground_positive\nCONTENT;\n\nelseif ( $content->reactionCount() < 0 ):\n$return .= <<<CONTENT\nipsAreaBackground_negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsAreaBackground_light\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsType_blendLinks \nCONTENT;\n\nif ( !\\count( $content->reactions() ) ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-role='reactCount'>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url('showReactions'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<span data-role='reactCountText'>\nCONTENT;\n$return .= htmlspecialchars( $content->reactionCount(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsReact_blurb \nCONTENT;\n\nif ( !$content->reactBlurb() ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-role='reactionBlurb'>\n\t\t\t\t\nCONTENT;\n\nif ( $content->reactBlurb() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reactionBlurb( $content );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\n\t\t\nCONTENT;\n\nif ( $content->canReact() ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$reactButton = NULL;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$defaultReaction = NULL;\n$return .= <<<CONTENT\n\n\t\n\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Content\\Reaction::roots() AS $id => $reaction ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( !$defaultReaction ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$defaultReaction = $reaction;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( ( $content->reacted() !== FALSE && $reaction->id == $content->reacted()->id ) || ( $content->reacted() === FALSE ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$reactButton = $reaction;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nbreak;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $allowRep ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='ipsReact_count ipsHide' data-role=\"reactCount\">\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url('showReactions'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= htmlspecialchars( \\count( $content->reactions() ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t<\/span>\n\t\t\t\t<div class='ipsReact_types' data-role='reactionInteraction' data-unreact=\"\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'unreact' )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\nCONTENT;\n\nif ( !\\IPS\\Content\\Reaction::isLikeMode() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<ul class='ipsList_inline' data-role='reactTypes'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Content\\Reaction::roots() AS $id => $reaction ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $reaction->id == $reactButton->id OR $reaction->_enabled === FALSE ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\ncontinue;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'react' )->setQueryString( 'reaction', $reaction->id )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsReact_reaction' data-role=\"reaction\" \nCONTENT;\n\nif ( $reaction->id == $defaultReaction->id ):\n$return .= <<<CONTENT\ndata-defaultReaction\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\t\t\t\t<img src='\nCONTENT;\n\n$return .= \\IPS\\File::get( \"core_Reaction\", $reaction->_icon )->url;\n$return .= <<<CONTENT\n' alt=\"\nCONTENT;\n\n$val = \"reaction_title_{$reaction->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip title=\"\nCONTENT;\n\n$val = \"reaction_title_{$reaction->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\t\t\t\t<span class='ipsReact_name'>\nCONTENT;\n\n$val = \"reaction_title_{$reaction->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'unreact' )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsReact_unreact \nCONTENT;\n\nif ( $content->reacted() == FALSE ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-action='unreact' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reaction_remove', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>&times;<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\n\t\t\t\t\t<span class='ipsReact_button \nCONTENT;\n\nif ( $content->reacted() !== FALSE ):\n$return .= <<<CONTENT\nipsReact_reacted\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-action='reactLaunch'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url( 'react' )->setQueryString( 'reaction', $reactButton->id )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsReact_reaction' data-role=\"reaction\" \nCONTENT;\n\nif ( $reactButton->id == $defaultReaction->id ):\n$return .= <<<CONTENT\ndata-defaultReaction\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\t<img src='\nCONTENT;\n\n$return .= \\IPS\\File::get( \"core_Reaction\", $reactButton->_icon )->url;\n$return .= <<<CONTENT\n' alt=\"\nCONTENT;\n\n$val = \"reaction_title_{$reactButton->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip title=\"\nCONTENT;\n\n$val = \"reaction_title_{$reactButton->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\t<span class='ipsReact_name'>\nCONTENT;\n\n$val = \"reaction_title_{$reactButton->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t<\/span>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reputationOthers( $contentURL, $lang, $names ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Content\\Reaction::isLikeMode() ):\n$return .= <<<CONTENT\n\n<a href='\nCONTENT;\n$return .= htmlspecialchars( $contentURL, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-destructOnClose data-ipsDialog-size='medium' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'like_log_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_liked', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip data-ipsTooltip-label='\nCONTENT;\n$return .= htmlspecialchars( $names, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-ipsTooltip-json data-ipsTooltip-safe>\nCONTENT;\n$return .= htmlspecialchars( $lang, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n<a href='\nCONTENT;\n$return .= htmlspecialchars( $contentURL, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-destructOnClose data-ipsDialog-size='medium' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_who_reacted', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip data-ipsTooltip-label='\nCONTENT;\n$return .= htmlspecialchars( $names, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-ipsTooltip-json data-ipsTooltip-safe>\nCONTENT;\n$return .= htmlspecialchars( $lang, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction review( $item, $review, $editorName, $app, $type ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='review-\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap' data-controller='core.front.core.comment' data-commentApp='\nCONTENT;\n$return .= htmlspecialchars( $app, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-commentType='\nCONTENT;\n$return .= htmlspecialchars( $type, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n-review' data-commentID=\"\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-quoteData='\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( array('userid' => $review->author()->member_id, 'username' => $review->author()->name, 'timestamp' => $review->mapped('date'), 'contentapp' => $app, 'contenttype' => $type, 'contentid' => $item->id, 'contentcommentid' => $review->id) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsComment_content ipsType_medium'>\n\t<div class='ipsComment_header ipsPhotoPanel ipsPhotoPanel_small ipsPhotoPanel_notPhone'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $review->author(), 'small', $review->warningRef(), 'ipsPos_left' );\n$return .= <<<CONTENT\n\n\t\t<div>\n\t\t\t<p class='ipsPos_right ipsType_reset'>\n\t\t\t\t\nCONTENT;\n\nif ( $review->canReportOrRevoke() === TRUE ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('report'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-remoteSubmit data-ipsDialog-size='medium' data-ipsDialog-flashMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_submit_success', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-action='reportComment' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a> &middot; \n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t<a class='ipsType_blendLinks' href='\nCONTENT;\n$return .= htmlspecialchars( $review->item()->url()->setQueryString( array( 'do' => 'findReview', 'review' => $review->id ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_this_review', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-closeOnClick='false' id='elShareComment_\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role='shareComment'><i class='fa fa-share-alt'><\/i><\/a>\n\t\t\t\t\nCONTENT;\n\nif ( \\count( $item->reviewMultimodActions() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class='ipsCustomInput'>\n\t\t\t\t\t\t<input type=\"checkbox\" name=\"multimod[\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\" value=\"1\" data-role=\"moderation\" data-actions=\"\nCONTENT;\n\nif ( $review->hidden() === -1 AND $review->canUnhide() ):\n$return .= <<<CONTENT\nunhide\nCONTENT;\n\nelseif ( $review->hidden() === 1 AND $review->canUnhide() ):\n$return .= <<<CONTENT\napprove\nCONTENT;\n\nelseif ( $review->canHide() ):\n$return .= <<<CONTENT\nhide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $review->canDelete() ):\n$return .= <<<CONTENT\ndelete\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-state='\nCONTENT;\n\nif ( $review->tableStates() ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $review->tableStates(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<span><\/span>\n\t\t\t\t\t<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t\t<h3 class=\"ipsComment_author ipsType_blendLinks\">\n\t\t\t\t<strong class='ipsType_normal'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLink( $review->author(), $review->warningRef() );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reputationBadge( $review->author() );\n$return .= <<<CONTENT\n\n\t\t\t<\/h3>\n\t\t\t<p class=\"ipsComment_meta ipsType_medium ipsType_light\">\n\t\t\t\t\nCONTENT;\n\nif ( $review->mapped('date') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$val = ( $review->mapped('date') instanceof \\IPS\\DateTime ) ? $review->mapped('date') : \\IPS\\DateTime::ts( $review->mapped('date') );$return .= $val->html();\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unknown_date', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\nCONTENT;\n\nif ( $review->editLine() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; {$review->editLine()}\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $review->hidden() AND $review->hidden() != -2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; \nCONTENT;\n$return .= htmlspecialchars( $review->hiddenBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelseif ( $review->hidden() == -2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; \nCONTENT;\n$return .= htmlspecialchars( $review->deletedBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t\t<ul class='ipsList_inline ipsClearfix ipsRating ipsRating_large'>\n\t\t\t\t\nCONTENT;\n\nforeach ( range( 1, \\intval( \\IPS\\Settings::i()->reviews_rating_out_of ) ) as $i ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='\nCONTENT;\n\nif ( $review->mapped('rating') >= $i ):\n$return .= <<<CONTENT\nipsRating_on\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsRating_off\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<i class='fa fa-star'><\/i>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>&nbsp;&nbsp; \nCONTENT;\n\nif ( $review->mapped('votes_total') ):\n$return .= <<<CONTENT\n<strong class='ipsType_medium'>{$review->helpfulLine()}<\/strong><br>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\t<div class='ipsPad'>\n\t\t<div id=\"review-\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-role=\"commentContent\" class=\"ipsType_richText ipsType_normal ipsContained\" data-controller='core.front.core.lightboxedImages'>\n\t\t\t{$review->content()}\n\t\t<\/div>\n\n\t\t\nCONTENT;\n\nif ( $review->hasAuthorResponse() ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsReviewResponse ipsPad ipsSpacer_bottom ipsAreaBackground_light ipsClearfix'>\n\t\t\t\t<h4 class='ipsType_sectionHead ipsType_medium ipsType_bold ipsSpacer_bottom ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'review_response_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t<div data-role=\"reviewResponse\" class=\"ipsType_richText ipsType_normal ipsContained ipsType_light\" data-controller='core.front.core.lightboxedImages'>\n\t\t\t\t\t{$review->mapped('author_response')}\n\t\t\t\t<\/div>\n\n\t\t\t\t\nCONTENT;\n\nif ( $review->canEditResponse() OR $review->canDeleteResponse() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<ul class='ipsComment_controls ipsClearfix ipsPos_right'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canEditResponse() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a class=\"ipsType_light\" href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('editResponse'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'review_author_respond', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canDeleteResponse() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a class=\"ipsType_light\" href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('deleteResponse')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\nCONTENT;\n\nif ( $review->hidden() !== 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $review->canRespond() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsPos_right ipsType_medium ipsSpacer_bottom ipsSpacer_half'>\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('respond'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_light' data-role='respond' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'review_author_respond', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'review_author_respond', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id and ( !$review->mapped('votes_data') or !array_key_exists( \\IPS\\Member::loggedIn()->member_id, json_decode( $review->mapped('votes_data'), TRUE ) ) ) and $review->author()->member_id != \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsType_medium'><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'did_you_find_this_helpful', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong> &nbsp;&nbsp;&nbsp;<a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('rate')->setQueryString( 'helpful', TRUE )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_light' data-action=\"rateReview\"><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'yes', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a> <a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('rate')->setQueryString( 'helpful', FALSE )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_light' data-action=\"rateReview\"><i class='fa fa-times'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\nCONTENT;\n\nif ( ( \\IPS\\Member::loggedIn()->member_id and ( !$review->mapped('votes_data') or !array_key_exists( \\IPS\\Member::loggedIn()->member_id, json_decode( $review->mapped('votes_data'), TRUE ) ) ) ) || $review->canEdit() || $review->canDelete() || $review->canHide() || $review->canUnhide() || ( $review->hidden() !== 1 && \\IPS\\IPS::classUsesTrait( $review, 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_enabled ) ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsItemControls'>\n\t\t\t\t\nCONTENT;\n\nif ( $review->hidden() !== 1 && \\IPS\\IPS::classUsesTrait( $review, 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reputation( $review );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $review->canEdit() || $review->canDelete() || $review->canHide() || $review->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<ul class='ipsComment_controls ipsClearfix ipsItemControls_left' data-role=\"commentControls\">\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->hidden() === 1 && ( $review->canUnhide() || $review->canDelete() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('unhide')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_positive' data-action='approveComment'><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'approve', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('delete')->csrf()->setPage('page',\\IPS\\Request::i()->page), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='deleteComment' data-updateOnDelete=\"#commentCount\" class='ipsButton ipsButton_verySmall ipsButton_negative'><i class='fa fa-times'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canEdit() || $review->canSplit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a href='#elControls_\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-appendTo='#review-\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'options', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &nbsp;<i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t\t\t\t<ul id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->mapped('first') and $review->item()->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->item()->url()->setQueryString( 'do', 'edit' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('edit'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='editComment'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canSplit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('split'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='splitComment' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->addToStack( $item::$title )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split_to_new', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('edit'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='editComment'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\t\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canDelete() || $review->canHide() || $review->canUnhide() || ( $review->hidden() == -2 AND \\IPS\\Member::loggedIn()->modPermission('can_manage_deleted_content') ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a href='#elControls_review\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' id='elControls_review\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-appendTo='#review-\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'options', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &nbsp;<i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t\t\t\t<ul id='elControls_review\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->hidden() == -2 AND \\IPS\\Member::loggedIn()->modPermission('can_manage_deleted_content') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('restore')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-confirmSubMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_visible_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_visible', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('restore')->csrf()->setQueryString( 'restoreAsHidden', 1 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-confirmSubMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_hidden_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_hidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('delete')->csrf()->setQueryString( 'immediately', 1 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-confirmSubMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete_immediately_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete_immediately', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review instanceof \\IPS\\Content\\Hideable ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( !$review->hidden() and $review->canHide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('hide')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $review->hidden() and $review->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('unhide')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unhide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $review->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $review->url('delete')->csrf()->setPage('page',\\IPS\\Request::i()->page), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='deleteComment' data-updateOnDelete=\"#reviewCount\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class='ipsHide' data-role='commentLoading'>\n\t\t\t\t\t\t\t<span class='ipsLoading ipsLoading_tiny ipsLoading_noAnim'><\/span>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t<\/ul>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t\n\t<div class='ipsMenu ipsMenu_wide ipsHide cPostShareMenu' id='elShareComment_\nCONTENT;\n$return .= htmlspecialchars( $review->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu'>\n\t\t<div class='ipsPad'>\n\t\t\t<h4 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_this_review', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t<hr class='ipsHr'>\n\t\t\t<h5 class='ipsType_normal ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'link_to_review', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h5>\n\t\t\t<input type='text' value='\nCONTENT;\n$return .= htmlspecialchars( $review->item()->url()->setQueryString( array( 'do' => 'findReview', 'review' => $review->id ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsField_fullWidth'>\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reviewContainer( $item, $review ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$idField = $review::$databaseColumnId;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $review->isIgnored() ):\n$return .= <<<CONTENT\n\n\t<div class='ipsComment ipsComment_ignored ipsPad_half ipsType_light'>\n\t\t\nCONTENT;\n\n$sprintf = array($review->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ignoring_content', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<a id='review-\nCONTENT;\n$return .= htmlspecialchars( $review->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/a>\n\t<article id=\"elReview_\nCONTENT;\n$return .= htmlspecialchars( $review->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsComment ipsComment_parent ipsClearfix ipsClear \nCONTENT;\n\nif ( $review->hidden() OR $item->hidden() == -2 ):\n$return .= <<<CONTENT\nipsModerated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->review( $item, $review, $item::$formLangPrefix . 'review', $item::$application, $item::$module );\n$return .= <<<CONTENT\n\n\t<\/article>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction reviewHelpful( $helpful, $total ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<span class='ipsResponsive_hidePhone ipsResponsive_inline'>\n\t\nCONTENT;\n\n$sprintf = array($helpful, \\IPS\\Member::loggedIn()->language()->pluralize( \\IPS\\Member::loggedIn()->language()->get( 'x_members' ), array( $total ) )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'x_members_found_helpful', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n<\/span>\n<span class='ipsResponsive_showPhone ipsResponsive_inline'>\n\t<i class='fa fa-smile-o'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $helpful, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \/ \nCONTENT;\n\n$pluralize = array( $total ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'x_members_found_helpful_phone', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\n<\/span>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction rssMenu(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( \\count( \\IPS\\Output::i()->rssFeeds ) ):\n$return .= <<<CONTENT\n\n\t<a href='#' id='elRSS' class='ipsPos_right ipsType_large' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'available_rss', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip data-ipsMenu data-ipsMenu-above><i class='fa fa-rss-square'><\/i><\/a>\n\t<ul id='elRSS_menu' class='ipsMenu ipsMenu_auto ipsHide'>\n\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->rssFeeds as $title => $url ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsMenu_item'><a title=\"\nCONTENT;\n\n$val = \"{$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" href=\"\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$val = \"{$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction sharelinks( $item ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\count( $item->sharelinks() )  ):\n$return .= <<<CONTENT\n\n\t<ul class='ipsList_inline ipsList_noSpacing ipsClearfix' data-controller=\"core.front.core.sharelink\">\n\t\t\nCONTENT;\n\nforeach ( $item->sharelinks() as $sharelink  ):\n$return .= <<<CONTENT\n\n\t\t\t<li>{$sharelink}<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction sidebar( $position='left' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$adsForceSidebar = ( \\IPS\\Settings::i()->ads_force_sidebar AND \\IPS\\core\\Advertisement::loadByLocation( 'ad_sidebar' ) );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( (isset( \\IPS\\Output::i()->sidebar['enabled'] ) and \\IPS\\Output::i()->sidebar['enabled'] ) && ( ( isset( \\IPS\\Output::i()->sidebar['contextual'] ) && trim( \\IPS\\Output::i()->sidebar['contextual'] ) !== '' ) || ( isset( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) && \\count( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) ) || ( \\IPS\\Dispatcher::i()->application instanceof \\IPS\\Application AND \\IPS\\Dispatcher::i()->application->canManageWidgets() ) || $adsForceSidebar ) ):\n$return .= <<<CONTENT\n\n\t<div id='ipsLayout_sidebar' class='ipsLayout_sidebar\nCONTENT;\n$return .= htmlspecialchars( $position, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( !( isset( \\IPS\\Output::i()->sidebar['contextual'] ) && trim( \\IPS\\Output::i()->sidebar['contextual'] ) !== '' ) && ( !isset( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) || !\\count( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) ) && \\IPS\\Dispatcher::i()->application->canManageWidgets() && !$adsForceSidebar ):\n$return .= <<<CONTENT\nipsLayout_sidebarUnused\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-controller='core.front.widgets.sidebar'>\n\t\t\nCONTENT;\n\nif ( $announcements = \\IPS\\core\\Announcements\\Announcement::loadAllByLocation( 'sidebar' ) AND ( ( isset( \\IPS\\Output::i()->sidebar['contextual'] ) && trim( \\IPS\\Output::i()->sidebar['contextual'] ) !== '' ) OR ( isset( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) && \\count( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->announcementSidebar( $announcements );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( isset( \\IPS\\Output::i()->sidebar['contextual'] ) && trim( \\IPS\\Output::i()->sidebar['contextual'] ) !== '' ):\n$return .= <<<CONTENT\n\n\t\t\t<aside id=\"elContextualTools\" class='ipsClearfix' \nCONTENT;\n\nif ( isset( \\IPS\\Output::i()->sidebar['sticky'] ) ):\n$return .= <<<CONTENT\ndata-ipsSticky\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Output::i()->sidebar['contextual'];\n$return .= <<<CONTENT\n\n\t\t\t<\/aside>\n\t\t\t<hr class='ipsHr ipsSpacer_both ipsSpacer_double'>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $adsForceSidebar OR ( \\IPS\\core\\Advertisement::loadByLocation( 'ad_sidebar' ) AND ( ( isset( \\IPS\\Output::i()->sidebar['contextual'] ) && trim( \\IPS\\Output::i()->sidebar['contextual'] ) !== '' ) OR ( isset( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) && \\count( \\IPS\\Output::i()->sidebar['widgets']['sidebar'] ) ) ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<div data-role='sidebarAd'>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\core\\Advertisement::loadByLocation( 'ad_sidebar' );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\t<br><br>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->widgetContainer( 'sidebar', 'vertical' );\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction signature( $member ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $member->canEditSignature() AND !\\IPS\\Member::loggedIn()->isIgnoring( $member, 'signatures' ) AND \\IPS\\Member::loggedIn()->members_bitoptions['view_sigs'] ):\n$return .= <<<CONTENT\n\n\t<div data-role=\"memberSignature\" class='\nCONTENT;\n\nif ( !\\IPS\\Settings::i()->signatures_mobile ):\n$return .= <<<CONTENT\nipsResponsive_hidePhone\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t<hr class='ipsHr'>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$uniqid = mt_rand();\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsPos_right'>\n\t\t\t\t\t<a href='#elSigIgnore\nCONTENT;\n$return .= htmlspecialchars( $uniqid, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' data-memberID=\"\nCONTENT;\n$return .= htmlspecialchars( $member->member_id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" id='elSigIgnore\nCONTENT;\n$return .= htmlspecialchars( $uniqid, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role='signatureOptions' data-ipsMenu class='ipsFaded ipsFaded_more ipsFaded_withHover ipsType_light' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_signature_options', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<i class='fa fa-times'><\/i> <i class='fa fa-caret-down'><\/i>\n\t\t\t\t\t<\/a>\n\n\t\t\t\t\t<ul class='ipsMenu ipsMenu_medium ipsHide' id='elSigIgnore\nCONTENT;\n$return .= htmlspecialchars( $uniqid, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id != $member->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class='ipsMenu_item' data-ipsMenuValue='oneSignature'>\n\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ignore&do=ignoreType&type=signatures&member_id={$member->member_id}\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"ignore\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$sprintf = array($member->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide_members_signature', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class='ipsMenu_item' data-ipsMenuValue='allSignatures'>\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=toggleSigs\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"settings\", array(), 0 )->addRef((string) \\IPS\\Request::i()->url()), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide_all_signatures', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t<div class='ipsType_light ipsType_richText' data-ipsLazyLoad>\n\t\t\t{$member->signature}\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction siteSocialProfiles(   ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->site_social_profiles AND $links = json_decode( \\IPS\\Settings::i()->site_social_profiles, TRUE ) AND \\count( $links ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nforeach ( $links as $profile ):\n$return .= <<<CONTENT\n\n\t\t<li class='cUserNav_icon'>\n\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $profile['key'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target='_blank' class='cShareLink cShareLink_\nCONTENT;\n$return .= htmlspecialchars( $profile['value'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' rel='noopener noreferrer'><i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $profile['value'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i><\/a>\n\t\t<\/li>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction tabs( $tabNames, $activeId, $defaultContent, $url, $tabParam='tab', $parseNames=TRUE, $contained=FALSE, $extraClasses='' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='ipsTabs ipsClearfix\nCONTENT;\n\nif ( $extraClasses ):\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $extraClasses, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' id='elTabs_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTabBar data-ipsTabBar-contentArea='#ipsTabs_content_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\ndata-ipsTabBar-updateURL='false'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t<a href='#elTabs_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\count( $tabNames ) > 1 ):\n$return .= <<<CONTENT\ndata-action='expandTabs'><i class='fa fa-caret-down'><\/i>\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\n\t<ul role='tablist'>\n\t\t\nCONTENT;\n\nforeach ( $tabNames as $i => $name ):\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( $tabParam, $i ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class=\"ipsTabs_item \nCONTENT;\n\nif ( $i == $activeId ):\n$return .= <<<CONTENT\nipsTabs_activeItem\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" title='\nCONTENT;\n\nif ( $parseNames ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= strip_tags( \\IPS\\Member::loggedIn()->language()->get( $name ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= strip_tags( $name );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' role=\"tab\" aria-selected=\"\nCONTENT;\n\nif ( $i == $activeId ):\n$return .= <<<CONTENT\ntrue\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfalse\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\nCONTENT;\n\nif ( $parseNames ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$val = \"{$name}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n{$name}\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/div>\n<section id='ipsTabs_content_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsTabs_panels \nCONTENT;\n\nif ( $contained ):\n$return .= <<<CONTENT\nipsTabs_contained\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nforeach ( $tabNames as $i => $name ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $i == $activeId ):\n$return .= <<<CONTENT\n\n\t\t\t<div id='ipsTabs_elTabs_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_panel' class=\"ipsTabs_panel\" aria-labelledby=\"\nCONTENT;\n\n$return .= htmlspecialchars( md5( $url ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" aria-hidden=\"false\">\n\t\t\t\t{$defaultContent}\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/section>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction tag( $tag, $tagEditUrl=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\n$urlEncodedTag = rawurlencode( $tag );\n$return .= <<<CONTENT\n\n<li \nCONTENT;\n\nif ( $tagEditUrl ):\n$return .= <<<CONTENT\nclass='ipsTags_deletable'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search&tags={$urlEncodedTag}\", null, \"tags\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" class='ipsTag' title=\"\nCONTENT;\n\n$sprintf = array($tag); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'find_tagged_content', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\" rel=\"tag\"><span>\nCONTENT;\n$return .= htmlspecialchars( $tag, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span><\/a>\n\t\nCONTENT;\n\nif ( $tagEditUrl ):\n$return .= <<<CONTENT\n\n\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $tagEditUrl->setQueryString( 'do', 'editTags' )->setQueryString( 'removeTag', $tag )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsTag_remove' data-action='removeTag' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'remove_tag', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>&times;<\/a>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/li>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction tags( $tags, $showCondensed=FALSE, $hideResponsive=FALSE, $tagEditUrl=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$id = mt_rand();\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\count( $tags ) OR $tagEditUrl ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $showCondensed ):\n$return .= <<<CONTENT\n\n\t\t<ul class='ipsTags ipsTags_inline ipsList_inline \nCONTENT;\n\nif ( $hideResponsive ):\n$return .= <<<CONTENT\nipsResponsive_hidePhone ipsResponsive_inline\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\nCONTENT;\n\nif ( \\count( $tags ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nforeach ( $tags as $idx => $tag ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $idx < 2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->tag( $tag, $tagEditUrl );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\count( $tags ) > 2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsType_small'>\n\t\t\t\t\t<span class='ipsType_light ipsCursor_pointer' data-ipsMenu id='elTags_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$pluralize = array( \\count( $tags ) - 2 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'and_x_more', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down ipsJS_show'><\/i><\/span>\n\t\t\t\t\t<div class='ipsHide ipsMenu ipsMenu_normal ipsPad_half cTagPopup' id='elTags_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu'>\n\t\t\t\t\t\t<p class='ipsType_medium ipsType_reset ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'tagged_with', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t<ul class='ipsTags ipsList_inline'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $tags as $tag ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->tag( $tag, NULL );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<ul class='ipsTags ipsList_inline \nCONTENT;\n\nif ( $hideResponsive ):\n$return .= <<<CONTENT\nipsResponsive_hidePhone ipsResponsive_inline\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( $tagEditUrl ):\n$return .= <<<CONTENT\ndata-controller='core.front.core.tagEditor' data-tagEditID='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Settings::i()->tags_min ):\n$return .= <<<CONTENT\ndata-minTags='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->tags_min;\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( \\IPS\\Settings::i()->tags_max ):\n$return .= <<<CONTENT\ndata-maxTags='\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->tags_max;\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\nCONTENT;\n\nif ( \\count( $tags ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nforeach ( $tags as $tag ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->tag( $tag, $tagEditUrl );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $tagEditUrl ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsTags_edit'>\n\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $tagEditUrl->setQueryString( 'do', 'editTags' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_tags', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsMenu data-ipsMenu-closeOnClick='false' id='elTagEditor_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_veryVerySmall ipsButton_light'><i class='fa fa-plus'><\/i>\nCONTENT;\n\nif ( !\\count( $tags ) ):\n$return .= <<<CONTENT\n \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'add_tags', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\t\nCONTENT;\n\nif ( $tagEditUrl ):\n$return .= <<<CONTENT\n\n\t\t\t<div id='elTagEditor_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_wide ipsHide'>\n\t\t\t\t<div data-controller='core.front.core.tagEditorForm'>\n\t\t\t\t\t<div class='ipsPad'>\n\t\t\t\t\t\t<span><i class='icon-spinner2 ipsLoading_tinyIcon'><\/i>  &nbsp;\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'loading', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction thumbImage( $image, $name, $size='medium', $classes='', $lang='view_this', $url='', $extension='core_Attachment', $dataParam='', $lazyLoad=false ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( $image ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$image = ( $image instanceof \\IPS\\File ) ? (string) $image->url : $image;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $url ):\n$return .= <<<CONTENT\n<a \nCONTENT;\n\nif ( $dataParam ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $dataParam, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\nhref='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$val = \"{$lang}\"; $sprintf = array($name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n<span\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( !$lazyLoad || !\\IPS\\Settings::i()->lazy_load_enabled ):\n$return .= <<<CONTENT\nstyle='background-image: url( \"\nCONTENT;\n\n$return .= \\IPS\\File::get( $extension, $image )->url;\n$return .= <<<CONTENT\n\" )'\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\ndata-background-src='\nCONTENT;\n\n$return .= \\IPS\\File::get( $extension, $image )->url;\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n class='\nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n ipsThumb ipsThumb_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n ipsThumb_bg'>\n\t\t<img \nCONTENT;\n\nif ( $lazyLoad && \\IPS\\Settings::i()->lazy_load_enabled ):\n$return .= <<<CONTENT\nsrc='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Text\\Parser::blankImage(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\nsrc='\nCONTENT;\n\n$return .= \\IPS\\File::get( $extension, $image )->url;\n$return .= <<<CONTENT\n' alt=''>\n\t\nCONTENT;\n\nif ( $url ):\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $url ):\n$return .= <<<CONTENT\n<a \nCONTENT;\n\nif ( $dataParam ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $dataParam, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\nhref='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$val = \"{$lang}\"; $sprintf = array($name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n<span\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n class='\nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n ipsNoThumb ipsThumb ipsThumb_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\nif ( $url ):\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction updateWarning(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->announcementTop(  );\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->isAdmin() ):\n$return .= <<<CONTENT\n\n<div data-controller=\"core.admin.core.notificationList\" class=\"cNotificationList\">\n\t\nCONTENT;\n\nforeach ( \\IPS\\core\\AdminNotification::notifications( NULL, array( \\IPS\\core\\AdminNotification::SEVERITY_CRITICAL ) ) as $notification ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$style = $notification->style();\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsAreaBackground_light ipsPad ipsPhotoPanel ipsPhotoPanel_small ipsPhotoPanel_notPhone cAcpNotificationBanner cAcpNotificationBanner_\nCONTENT;\n$return .= htmlspecialchars( $style, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n ipsClearf\">\n\t\t\t<div class=\"ipsPos_right\">\n\t\t\t\t<span class=\"ipsType_small\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'acp_notification_frontend_explain', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\nCONTENT;\n\n$dismissible = $notification->dismissible();\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $dismissible !== $notification::DISMISSIBLE_NO ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&nbsp;\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ajax&do=dismissAcpNotification&id={$notification->id}\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" class=\"cAcpNotificationBanner_close\" title=\"\nCONTENT;\n\n$val = \"acp_notification_dismiss_{$dismissible}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip data-action=\"dismiss\">\n\t\t\t\t\t\t<i class=\"fa fa-times\"><\/i>\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\t<i class='fa fa-\nCONTENT;\n\nif ( $style == $notification::STYLE_INFORMATION OR $style == $notification::STYLE_EXPIRE ):\n$return .= <<<CONTENT\ninfo-circle\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nwarning\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n cAcpNotificationBanner_mainIcon ipsPos_left ipsResponsive_hidePhone'><\/i>\n\t\t\t<div>\n\t\t\t\t<h2 class='ipsType_sectionHead'><strong>{$notification->title()}<\/strong><\/h2>\n\t\t\t\t<div class='ipsType_richText ipsType_normal'>{$notification->body()}<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction userBar(   ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id  ):\n$return .= <<<CONTENT\n\n\t<ul id=\"elUserNav\" class=\"ipsList_inline cSignedIn ipsClearfix ipsResponsive_showDesktop\" data-controller=\"core.front.core.userbar\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id && \\IPS\\Settings::i()->auto_polling_enabled ):\n$return .= <<<CONTENT\n,core.front.core.instantNotifications\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['social_links'] == 'header' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->siteSocialProfiles(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->restrict_post and \\count( \\IPS\\Member::loggedIn()->createMenu() ) ):\n$return .= <<<CONTENT\n\n\t\t\t<li id=\"cCreate\">\n\t\t\t\t<a href=\"#elCreateNew_menu\" id=\"elCreateNew\" data-ipstooltip data-ipsmenu title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'create_menu_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<strong><i class=\"fa fa-plus\"><\/i> \u00a0\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'create_menu', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong> <i class=\"fa fa-caret-down\"><\/i>\n\t\t\t\t<\/a>\n\t\t\t\t<div id=\"elCreateNew_menu\" class=\"ipsMenu ipsMenu_auto ipsHide\">\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Member::loggedIn()->createMenu() as $k => $url ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\">\n\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $url['link'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( isset( $url['extraData'] ) ):\n$return .= <<<CONTENT\n \nCONTENT;\n\nforeach ( $url['extraData'] as $data => $v ):\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $data, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset($url['title']) AND $url['title'] ):\n$return .= <<<CONTENT\n data-ipsdialog-title=\"\nCONTENT;\n\n$val = \"{$url['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset($url['flashMessage']) ):\n$return .= <<<CONTENT\n data-ipsdialog-flashmessage=\"\nCONTENT;\n\n$val = \"{$url['flashMessage']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$val = \"{$k}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/div>\n\t\t\t<\/li>\n\t\t\t<li class=\"elUserNav_sep\">\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<li class=\"cNotifications cUserNav_icon\">\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications\", null, \"notifications\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" id=\"elFullNotifications\" data-ipstooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'userbar_notifications', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-ipsmenu data-ipsmenu-closeonclick=\"false\">\n\t\t\t\t<i class=\"fa fa-bell\"><\/i> <span class=\"ipsNotificationCount \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->notification_cnt ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-notificationtype=\"notify\" data-currentcount=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->notification_cnt, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->notification_cnt, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/a>\n\t\t\t<div id=\"elFullNotifications_menu\" class=\"ipsMenu ipsMenu_wide ipsHide\">\n\t\t\t\t<div class=\"ipsMenu_headerBar\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications&do=options\", null, \"notifications_options\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" class=\"ipsType_light ipsPos_right\"><i class=\"fa fa-cog\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'notification_options', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<h4 class=\"ipsType_sectionHead\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'notifications', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t<\/div>\n\t\t\t\t<div class=\"ipsMenu_innerContent\">\n\t\t\t\t\t<div id=\"elNotificationsBrowser\" data-controller=\"core.front.core.notifications\"><\/div>\n\t\t\t\t\t<ol class=\"ipsDataList ipsDataList_readStatus\" data-role=\"notifyList\" data-ipskeynav data-ipskeynav-observe=\"return\" id=\"elNotifyContent\"><\/ol>\n\t\t\t\t<\/div>\n\t\t\t\t<div class=\"ipsMenu_footerBar ipsType_center\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=notifications\", null, \"notifications\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-bars\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_all_notifications', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/li>\n\t\t\nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->members_disable_pm and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'messaging' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<li class=\"cInbox cUserNav_icon\">\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=messaging&controller=messenger\", null, \"messaging\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" id=\"elFullInbox\" data-ipstooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'userbar_messages', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-ipsmenu data-ipsmenu-closeonclick=\"false\">\n\t\t\t\t\t<i class=\"fa fa-envelope\"><\/i> <span class=\"ipsNotificationCount \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->msg_count_new ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-notificationtype=\"inbox\" data-currentcount=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->msg_count_new, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->msg_count_new, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<\/a>\n\t\t\t\t<div id=\"elFullInbox_menu\" class=\"ipsMenu ipsMenu_wide ipsHide\" data-controller=\"core.front.core.messengerMenu\">\n\t\t\t\t\t<div class=\"ipsMenu_headerBar\">\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=messaging&controller=messenger&do=compose\", null, \"messenger_compose\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'compose_new', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsdialog-remotesubmit data-ipsdialog-destructonclose data-ipsdialog-flashmessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'message_sent', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" id=\"elMessengerPopup_compose\" class=\"ipsPos_right ipsButton ipsButton_primary ipsButton_verySmall\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'compose_new', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<h4 class=\"ipsType_sectionHead\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'userbar_messages', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class=\"ipsMenu_innerContent\"><ol class=\"ipsDataList\" data-role=\"inboxList\" data-ipskeynav data-ipskeynav-observe=\"return\" id=\"elInboxContent\"><\/ol><\/div>\n\t\t\t\t\t<div class=\"ipsMenu_footerBar ipsType_center\">\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=messaging&controller=messenger\", null, \"messaging\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-bars\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_to_inbox', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) and \\IPS\\Member::loggedIn()->modPermission('can_view_reports') ):\n$return .= <<<CONTENT\n\n\t\t\t<li class=\"cReports cUserNav_icon\">\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=modcp&controller=modcp&tab=reports\", null, \"modcp_reports\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" id=\"elFullReports\" data-ipstooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'userbar_reports', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-ipsmenu data-ipsmenu-closeonclick=\"false\">\n\t\t\t\t\t<i class=\"fa fa-warning\"><\/i> \nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->reportCount() ):\n$return .= <<<CONTENT\n<span class=\"ipsNotificationCount\" data-notificationtype=\"reports\">\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->reportCount(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t\t<div id=\"elFullReports_menu\" class=\"ipsMenu ipsMenu_wide ipsHide\">\n\t\t\t\t\t<div class=\"ipsMenu_headerBar\"><h4 class=\"ipsType_sectionHead\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_center_header', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4><\/div>\n\t\t\t\t\t<div class=\"ipsMenu_innerContent\" data-role=\"reportsList\"><\/div>\n\t\t\t\t\t<div class=\"ipsMenu_footerBar ipsType_center\">\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=modcp&controller=modcp&tab=reports\", null, \"modcp_reports\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-bars\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_center_link', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<li class=\"elUserNav_sep\">\n\t\t<li id=\"cUserLink\">\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::loggedIn(), 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t<a href=\"#elUserLink_menu\" id=\"elUserLink\" data-ipsmenu>\n\t\t\t\t\nCONTENT;\n\nif ( isset( $_SESSION['logged_in_as_key'] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$sprintf = array($_SESSION['logged_in_from']['name']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'front_logged_in_as', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n <i class=\"fa fa-caret-down\"><\/i>\n\t\t\t<\/a>\n\t\t\t<ul id=\"elUserLink_menu\" class=\"ipsMenu ipsMenu_normal ipsHide\">\n\t\t\t\t<li class=\"ipsMenu_title\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members', 'front' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"profile\"><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_my_profile', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_profile', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'messaging' ) ) and \\IPS\\Member::loggedIn()->members_disable_pm AND \\IPS\\Member::loggedIn()->members_disable_pm != 2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"messages\"><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=messaging&controller=messenger&do=enableMessenger\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"messaging\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_to_messenger', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-confirm data-confirmmessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_disabled_msg', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_messages', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['g_attach_max'] != 0 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"attachments\"><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=attachments\", null, \"attachments\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'my_attachments', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<li class=\"ipsMenu_title\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_settings_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\core\\Promote::promoteServices() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"promote\"><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=promote&controller=promote&do=view\", null, \"promote_manage\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'promote_manage_link', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Application::appIsEnabled('nexus') and \\IPS\\Settings::i()->nexus_subs_enabled ):\n$return .= <<<CONTENT\n\n            \t\t<li class=\"ipsMenu_item\" data-menuitem=\"subscriptions\"><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=nexus&module=subscriptions&controller=subscriptions\", null, \"nexus_subscriptions\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'nexus_manage_subscriptions', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n            \t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"manageFollowed\"><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=followed\", null, \"followed_content\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_followed_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t<li class=\"ipsMenu_item\" id=\"elAccountSettingsLink\" data-menuitem=\"settings\"><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings\", null, \"settings\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_account_settings', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_settings', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->ignore_system_on ):\n$return .= <<<CONTENT\n\n            \t    <li class=\"ipsMenu_item\" data-menuitem=\"ignoredUsers\"><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ignore\", null, \"ignore\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_manage_ignore', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n            \t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<li class=\"ipsMenu_sep\"><hr><\/li>\n\t\t\t\t\nCONTENT;\n\nif ( ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) AND \\IPS\\Member::loggedIn()->modPermission() ) or \\IPS\\Member::loggedIn()->isAdmin() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) AND \\IPS\\Member::loggedIn()->modPermission() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"modcp\"><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=modcp\", null, \"modcp\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_modcp', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->isAdmin() AND \\IPS\\SHOW_ACP_LINK  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"admincp\"><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"\", \"admin\", \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-lock\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'menu_admincp', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsMenu_sep\"><hr><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<li class=\"ipsMenu_item\" data-menuitem=\"signout\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login&do=logout\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"logout\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $_SESSION['logged_in_as_key'] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$sprintf = array($_SESSION['logged_in_from']['name']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'switch_to_account', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_out', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t<\/li>\n\t\t\t<\/ul>\n\t\t<\/li>\n\t<\/ul>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<ul id=\"elUserNav\" class=\"ipsList_inline cSignedOut ipsClearfix ipsResponsive_hidePhone ipsResponsive_block\">\n\t\t\nCONTENT;\n\nif ( \\IPS\\Theme::i()->settings['social_links'] != 'footer' ):\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->siteSocialProfiles(  );\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( !empty(\\IPS\\Settings::i()->wordpress_url) ):\n$return .= <<<CONTENT\n\n<li id=\"elSignInLink\">\n  <a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), \\IPS\\Settings::i()->logins_over_https ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" id=\"elUserSignIn\">\n    \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n  <\/a>\n<\/li>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n<li id=\"elSignInLink\">\n  <a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), \\IPS\\Settings::i()->logins_over_https ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" data-ipsmenu-closeonclick=\"false\" data-ipsmenu id=\"elUserSignIn\">\n    \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n \u00a0<i class=\"fa fa-caret-down\"><\/i>\n  <\/a>\n  \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->loginPopup( new \\IPS\\Login( \\IPS\\Http\\Url::internal( 'app=core&module=system&controller=login', 'front', 'login', NULL, \\IPS\\Settings::i()->logins_over_https ) ) );\n$return .= <<<CONTENT\n\n<\/li>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Login::registrationType() != 'disabled' ):\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Login::registrationType() == 'redirect' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Settings::i()->allow_reg_target, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" target=\"_blank\" rel=\"noopener\" class=\"ipsButton ipsButton_normal ipsButton_primary\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=register\", null, \"register\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( \\IPS\\Login::registrationType() == 'normal' ):\n$return .= <<<CONTENT\ndata-ipsdialog data-ipsdialog-size=\"narrow\" data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n id=\"elRegisterButton\" class=\"ipsButton ipsButton_normal ipsButton_primary\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction userLink( $member, $warningRef=NULL, $groupFormatting=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$groupFormatting = ( $groupFormatting === NULL ) ? ( ( \\IPS\\Settings::i()->group_formatting == 'global' ) ? TRUE : FALSE ) : $groupFormatting;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $member->member_id AND \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members' ) )  ):\n$return .= <<<CONTENT\n<a href='\nCONTENT;\n\nif ( $warningRef ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $member->url()->setQueryString( 'wr', $warningRef ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $member->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsHover data-ipsHover-target='\nCONTENT;\n$return .= htmlspecialchars( $member->url()->setQueryString( array( 'do' => 'hovercard', 'wr' => $warningRef, 'referrer' => urlencode( \\IPS\\Request::i()->url() ) ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title=\"\nCONTENT;\n\n$sprintf = array($member->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_user_profile', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_break\">\nCONTENT;\n\nif ( $groupFormatting && $member->group['prefix'] ):\n$return .= <<<CONTENT\n{$member->group['prefix']}\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $member->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $groupFormatting && $member->group['suffix'] ):\n$return .= <<<CONTENT\n{$member->group['suffix']}\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $groupFormatting && $member->group['prefix'] ):\n$return .= <<<CONTENT\n{$member->group['prefix']}\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $member->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $groupFormatting && $member->group['suffix'] ):\n$return .= <<<CONTENT\n{$member->group['suffix']}\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction userLinkFromData( $id, $name, $seoName, $groupIdForFormatting=NULL, $groupFormatting=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $id AND \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members', 'front' ) )  ):\n$return .= <<<CONTENT\n<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$id}\", null, \"profile\", array( $seoName ?: \\IPS\\Http\\Url::seoTitle( $name ) ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-ipsHover data-ipsHover-target='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$id}&do=hovercard\", null, \"profile\", array( $seoName ?: \\IPS\\Http\\Url::seoTitle( $name ) ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title=\"\nCONTENT;\n\n$sprintf = array($name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_user_profile', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_break\">\nCONTENT;\n\nif ( $groupIdForFormatting AND ( $groupFormatting === TRUE OR ( $groupFormatting === NULL AND \\IPS\\Settings::i()->group_formatting == 'global' ) ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member\\Group::load( $groupIdForFormatting )->formatName( $name );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $groupIdForFormatting AND ( $groupFormatting === TRUE OR ( $groupFormatting === NULL AND \\IPS\\Settings::i()->group_formatting == 'global' ) ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member\\Group::load( $groupIdForFormatting )->formatName( $name );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction userPhoto( $member, $size='small', $warningRef=NULL, $classes='', $hovercard=TRUE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $member->member_id and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members' ) ) ):\n$return .= <<<CONTENT\n\r\n\nCONTENT;\n\n$memberURL = ( $warningRef ) ? $member->url()->setQueryString( 'wr', $warningRef ) : $member->url();\n$return .= <<<CONTENT\n\r\n\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $memberURL, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( $hovercard ):\n$return .= <<<CONTENT\ndata-ipsHover data-ipsHover-target=\"\nCONTENT;\n$return .= htmlspecialchars( $memberURL->setQueryString( 'do', 'hovercard' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n class=\"ipsUserPhoto ipsUserPhoto_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $classes ):\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$sprintf = array($member->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_user_profile', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\r\n\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $member->photo, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt='\nCONTENT;\n$return .= htmlspecialchars( $member->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\r\n\t<\/a>\r\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\r\n\t<span class='ipsUserPhoto ipsUserPhoto_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $classes ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\r\n\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $member->photo, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt='\nCONTENT;\n$return .= htmlspecialchars( $member->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\r\n\t<\/span>\r\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction userPhotoFromData( $id, $name, $seoName, $photoUrl, $size='small', $classes='', $hovercard=TRUE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $id and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members' ) ) ):\n$return .= <<<CONTENT\n\n\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$id}\", null, \"profile\", array( $seoName ?: \\IPS\\Http\\Url::seoTitle( $name ) ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( $hovercard ):\n$return .= <<<CONTENT\ndata-ipsHover data-ipsHover-target=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$id}&do=hovercard\", null, \"profile\", array( $seoName ?: \\IPS\\Http\\Url::seoTitle( $name ) ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n class=\"ipsUserPhoto ipsUserPhoto_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $classes ):\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$sprintf = array($name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_user_profile', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\n\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $photoUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt='\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t<\/a>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<span class='ipsUserPhoto ipsUserPhoto_\nCONTENT;\n$return .= htmlspecialchars( $size, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $classes ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $classes, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $photoUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt='\nCONTENT;\n$return .= htmlspecialchars( $name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t<\/span>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction viglink(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<!--VIGLINK-->\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->viglink_groups =='all' or \\IPS\\Member::loggedIn()->inGroup( explode( ',', \\IPS\\Settings::i()->viglink_groups ) ) ):\n$return .= <<<CONTENT\n\n\t<script type=\"text\/javascript\">\n\t  var vglnk = { key: '\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->viglink_api_key;\n$return .= <<<CONTENT\n'\nCONTENT;\n\nif ( \\IPS\\Settings::i()->viglink_subid ):\n$return .= <<<CONTENT\n,\n\t                sub_id: '\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->viglink_subid;\n$return .= <<<CONTENT\n'\n\t                \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t              };\n\t\n\t  (function(d, t) {\n\t    var s = d.createElement(t); s.type = 'text\/javascript'; s.async = true;\n\t    s.src = '\/\/cdn.viglink.com\/api\/vglnk.js';\n\t    var r = d.getElementsByTagName(t)[0]; r.parentNode.insertBefore(s, r);\n\t  }(document, 'script'));\n\t<\/script>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction widgetContainer( $id, $orientation='horizontal' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $id == 'header' ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->announcementContentTop(  );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( ( isset( \\IPS\\Output::i()->sidebar['widgets'][ $id ] ) && \\count( \\IPS\\Output::i()->sidebar['widgets'][ $id ] ) ) || ( \\IPS\\Dispatcher::i()->application instanceof \\IPS\\Application AND \\IPS\\Dispatcher::i()->application->canManageWidgets() ) ):\n$return .= <<<CONTENT\n\n\t<div class='cWidgetContainer \nCONTENT;\n\nif ( !isset( \\IPS\\Output::i()->sidebar['widgets'][ $id ] ) or !\\count( \\IPS\\Output::i()->sidebar['widgets'][ $id ] ) ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Dispatcher::i()->application->canManageWidgets() ):\n$return .= <<<CONTENT\ndata-controller='core.front.widgets.area'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-role='widgetReceiver' data-orientation='\nCONTENT;\n$return .= htmlspecialchars( $orientation, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-widgetArea='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t<ul class='ipsList_reset'>\n\t\t\t\nCONTENT;\n\nif ( isset( \\IPS\\Output::i()->sidebar['widgets'][ $id ] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Output::i()->sidebar['widgets'][ $id ] as $widget ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$widgetHtml = (string) $widget;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsWidget ipsWidget_\nCONTENT;\n$return .= htmlspecialchars( $orientation, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n ipsBox\nCONTENT;\n\nif ( trim( $widgetHtml ) === '' ):\n$return .= <<<CONTENT\n ipsWidgetHide ipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset($widget->configuration['devices_to_show']) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\nforeach ( array_diff( array( 'Phone', 'Tablet', 'Desktop' ), $widget->configuration['devices_to_show'] ) as $device  ):\n$return .= <<<CONTENT\n ipsResponsive_hide\nCONTENT;\n$return .= htmlspecialchars( $device, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-blockID='\nCONTENT;\n\nif ( isset($widget->app) AND !empty($widget->app) ):\n$return .= <<<CONTENT\napp_\nCONTENT;\n$return .= htmlspecialchars( $widget->app, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nplugin_\nCONTENT;\n$return .= htmlspecialchars( $widget->plugin, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $widget->key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlspecialchars( $widget->uniqueKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nif ( $widget->hasConfiguration() ):\n$return .= <<<CONTENT\n data-blockConfig=\"true\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-blockTitle=\"\nCONTENT;\n\n$val = \"block_{$widget->key}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-blockErrorMessage=\"\nCONTENT;\n\n$val = \"{$widget->errorMessage}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-controller='core.front.widgets.block'>{$widgetHtml}<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}}"
VALUE;
