!function(e,t,a,r,n){if(!a)return console.error("jQuery not found.");r||(console.warn("Language object not found. Using English instead."),r={LB_GENERATING:"Generating...",MSG_RESULTS_WILL_APPEAR_HERE:"Results will appear here...",LB_GENERATE:"Generate",LB_RESULTS:"Results (%d)",LB_ADDING:"Adding...",MSG_UNDOCUMMENTED_ERROR:"Undocummented error.",LB_EDIT:"Edit",LB_HIDE_FILTERS:"Hide Advanced Filters",LB_SHOW_FILTERS:"Show Advanced Filters",MSG_ARE_YOU_SURE:"Are you sure?"}),a(t).ready(function(){a("#luser-wrapper form .o-btn-submit").on("click",function(e){e.preventDefault();var t=a(this),n=a(t.parents("form").get(0)),s=a("#qty"),l=parseInt(s.val());if(isNaN(l)||l<0||l>5e3)s.trigger("focus");else{var o=parseInt(a("#gender").val());o=isNaN(o)?0:o;var d=(a("#seed").val()||"").trim(),i=a("#nationalities").val()||[],c=a("#role").val()||"",u=a(".c-rowset"),p=a(".o-rowset-title"),h=a("#skip_review").is(":checked")?1:0;a.ajax({type:"GET",url:ajaxurl,data:{action:"luser:generate_users",nonce:t.data("nonce"),qty:l,gender:o,seed:d,nat:i.join(","),role:c,skip_review:h},beforeSend:function(){t.text(r.LB_GENERATING),t.addClass("disabled"),p.text(r.MSG_RESULTS_WILL_APPEAR_HERE).show(),u.addClass("u-hidden"),a("tbody",u).html(""),a("input, select",n).prop("disabled","disabled").addClass("disabled");a("#table-actions").addClass("u-hidden"),a('[data-action="select_all"]',u).prop("checked",!1)},success:function(e){t.text(r.LB_GENERATE),e.success?(p.text(r.LB_RESULTS.replace("%d",e.results_count)),a("tbody",u).html(a(e.data)),u.removeClass("u-hidden"),a("select",u).select2(),a("#table-actions").removeClass("u-hidden")):(p.hide(),alert(e.error))},error:function(e,t,a){alert(a)},complete:function(){t.removeClass("disabled"),a("input, select",n).prop("disabled",null).removeClass("disabled")}})}}),a(".c-rowset").on("click",'[data-action="user.add"]',function(e){e.preventDefault();var t=a(this),n=a(t.parents("tr")),s=a('[data-column="role"]',n),l=s.val(),o=a("td:last-child",n),d=o.html();a.ajax({type:"POST",url:ajaxurl,data:{action:"luser:add_user",nonce:t.data("nonce"),i:n.data("index"),user_fname:a('[data-column="first_name"]',n).text(),user_lname:a('[data-column="last_name"]',n).text(),user_uname:a('[data-column="username"]',n).text(),user_email:a('[data-column="email"]',n).text(),user_pwd:a('[data-column="password"]',n).text(),user_role:l},beforeSend:function(){o.text(r.LB_ADDING)},success:function(e){if(e.success){var t=a('option[value="'+l+'"]',s).text();a('[data-column="role"]',n).parent().text(t);var d=a("<a></a>",{target:"_blank",class:"",href:e.user_profile_url});d.html(r.LB_EDIT),o.html(d),a("> td:first-child",n).html("")}else e.error?console.error(e.error):console.error(r.MSG_UNDOCUMMENTED_ERROR)},error:function(){o.html(a(d))}})}),a(".c-rowset").on("click",'[data-action="user.discard"]',function(e){a(this).parents("tr[data-index]").remove();var t=a(".c-rowset"),n=a("tbody tr",t);0===n.length?(t.addClass("u-hidden"),a(".o-rowset-title").text(""),a("#table-actions").addClass("u-hidden")):a(".o-rowset-title").text(r.LB_RESULTS.replace("%d",n.length))}),a("#results-wrapper").on("click",'[data-action="users.select_all"]',function(e){var t=a(".c-rowset"),r=a('tbody input[type="checkbox"]',t);r.length>0&&r.prop("checked",a(this).prop("checked"))}),a("#luser-wrapper select").select2({width:"100%"}),a("#luser-wrapper").on("click",'[data-action="filters.show"]',function(e){e.preventDefault();var t=a(this),n=a(".c-advanced-filters");n.css("height",a("tbody",n).height()+"px"),n.addClass("s-expanded"),t.attr("data-action","filters.hide"),t.text(r.LB_HIDE_FILTERS)}),a("#luser-wrapper").on("click",'[data-action="filters.hide"]',function(e){e.preventDefault();var t=a(this),n=a(".c-advanced-filters");n.css("height",null),n.removeClass("s-expanded"),t.attr("data-action","filters.show"),t.text(r.LB_SHOW_FILTERS)}),a("#bulk-actions").on("change",function(){var e=a(this),t=e.val()||null;if(t){var n=a("#results-wrapper table .o-table-control-cbx:checked");if(n.length>0&&["add","discard"].indexOf(t)>=0){if(!confirm(r.MSG_ARE_YOU_SURE))return;n.each(function(){var e=a(a(this).parents("tr[data-index]")),r=a('[data-action="user.'+t+'"]',e);r.length>0&&r.trigger("click")})}e.select2("val",0)}}),a('#results-wrapper .c-rowset thead input[data-action="select_all"]').on("click",function(){var e=a(this),t=a(e.parents(".c-rowset")),r=e.is(":checked");a("> tbody td .o-table-control-cbx",t).prop("checked",r)})})}(window,window.document,"undefined"!=typeof jQuery?jQuery:null,"undefined"!=typeof $i18n?$i18n:null);